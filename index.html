<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>商務英語會話 (Unit 1-6 旗艦全收錄版)</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Merriweather:ital,wght@0,400;0,700;1,400&display=swap');
    body { font-family: 'Noto Sans TC', sans-serif; -webkit-tap-highlight-color: transparent; }
    .font-serif-en { font-family: 'Merriweather', serif; }
    .highlight-kw { font-weight: 700; border-bottom: 2px solid currentColor; }
    
    @keyframes pulse-red {
      0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
      100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
    }
    .animate-pulse-red { animation: pulse-red 1.5s infinite; }
    
    @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .animate-spin-slow { animation: spin-slow 2s linear infinite; }

    .animate-fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    
    .blind-mode-blur { filter: blur(6px); user-select: none; transition: filter 0.3s ease; cursor: help; }
    .blind-mode-blur:hover { filter: blur(0px); }

    .chunk-separator { color: #cbd5e1; font-weight: 300; margin: 0 6px; display: inline-block; transform: translateY(-1px); }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
    
    .word-correct { color: #16a34a; font-weight: bold; }
    .word-missed { color: #dc2626; text-decoration: line-through; opacity: 0.6; }
    
    .wave-bar { width: 4px; height: 10px; background-color: #fff; border-radius: 2px; animation: wave 1s ease-in-out infinite; }
    .wave-bar:nth-child(2) { animation-delay: 0.1s; }
    .wave-bar:nth-child(3) { animation-delay: 0.2s; }
    .wave-bar:nth-child(4) { animation-delay: 0.3s; }
    
    @keyframes slide-up-bounce {
        0% { transform: translateY(100%); opacity: 0; }
        70% { transform: translateY(-10px); opacity: 1; }
        100% { transform: translateY(0); opacity: 1; }
    }
    .animate-slide-up-bounce { animation: slide-up-bounce 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
  </style>
</head>
<body class="bg-gray-50 selection:bg-yellow-100 min-h-screen relative">

  <div id="root"></div>
  <div id="feedback-portal-root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef, useMemo, useCallback } = React;
    const { createPortal } = ReactDOM;

    let globalRecognition = null;
    let globalTimeout = null;

    const getSharedRecognition = () => {
      if (!globalRecognition) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (SpeechRecognition) {
          globalRecognition = new SpeechRecognition();
          globalRecognition.lang = 'en-US';
          globalRecognition.interimResults = false;
          globalRecognition.maxAlternatives = 1;
          globalRecognition.continuous = false; 
        }
      }
      return globalRecognition;
    };

    const Icon = ({ children, className, ...props }) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} {...props}>{children}</svg>
    );
    // Icons
    const Briefcase = (p) => <Icon {...p}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></Icon>;
    const BookOpen = (p) => <Icon {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></Icon>;
    const MessageCircle = (p) => <Icon {...p}><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></Icon>;
    const Link2 = (p) => <Icon {...p}><path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/></Icon>;
    const Play = (p) => <Icon {...p}><polygon points="5 3 19 12 5 21 5 3"/></Icon>;
    const Turtle = (p) => <Icon {...p}><path d="m19 12-1.5 3"/><path d="M16.5 10.5 19 8"/><path d="m7 16 1.5 3"/><path d="M7.5 10.5 5 8"/><path d="M12 21a6 6 0 0 0 6-6v-2a6 6 0 0 0-6-6 6 6 0 0 0-6 6v2a6 6 0 0 0 6 6Z"/><path d="M12 21V9"/><path d="M12 21a4 4 0 0 1-4-4H6"/><path d="M12 21a4 4 0 0 0 4-4h2"/></Icon>;
    const Volume2 = (p) => <Icon {...p}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></Icon>;
    const Info = (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></Icon>;
    const Trash2 = (p) => <Icon {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></Icon>;
    const X = (p) => <Icon {...p}><path d="M18 6 6 18"/><path d="m6 6 18 18"/></Icon>;
    const Save = (p) => <Icon {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></Icon>;
    const Lightbulb = (p) => <Icon {...p}><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5 0-3-2.5-5.5-5.5-5.5S7 5 7 8c0 1.5.5 2.5 1.5 3.5.8.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></Icon>;
    const Feather = (p) => <Icon {...p}><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" x2="2" y1="8" y2="22"/><line x1="17.5" x2="9" y1="15" y2="15"/></Icon>;
    const Layout = (p) => <Icon {...p}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="21" y2="9"/></Icon>;
    const MapPin = (p) => <Icon {...p}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></Icon>;
    const Zap = (p) => <Icon {...p}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></Icon>;
    const Mic = (p) => <Icon {...p}><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" x2="12" y1="19" y2="22"/></Icon>;
    const Check = (p) => <Icon {...p}><polyline points="20 6 9 17 4 12"/></Icon>;
    const AlertCircle = (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></Icon>;
    const MousePointerClick = (p) => <Icon {...p}><path d="M14 4.1 12 6"/><path d="m5.1 8-2.9-.8"/><path d="m6 12-1.9 2"/><path d="M7.2 2.2 8 5.1"/><path d="M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z"/></Icon>;
    const Filter = (p) => <Icon {...p}><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></Icon>;
    const Settings = (p) => <Icon {...p}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></Icon>;
    const Wifi = (p) => <Icon {...p}><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></Icon>;
    const Eye = (p) => <Icon {...p}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></Icon>;
    const EyeOff = (p) => <Icon {...p}><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/></Icon>;
    const Scissors = (p) => <Icon {...p}><circle cx="6" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><line x1="20" x2="8.12" y1="4" y2="15.88"/><line x1="14.47" x2="20" y1="14.48" y2="20"/><line x1="8.12" x2="12" y1="8.12" y2="12"/></Icon>;
    const Loader2 = (p) => <Icon {...p}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></Icon>;
    const CreditCard = (p) => <Icon {...p}><rect width="20" height="14" x="2" y="5" rx="2" ry="2"/><line x1="2" x2="22" y1="10" y2="10"/></Icon>;
    const AlertTriangle = (p) => <Icon {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></Icon>;

    const speakText = (text, rate = 0.85) => {
      window.speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = rate;
      window.speechSynthesis.speak(utterance);
    };

    const cleanText = (text) => {
      if (!text) return "";
      return text.replace(/<[^>]*>/g, '').replace(/[.,\/#!$%\^&\*;:{}=\-_`~?]/g, "").replace(/\s{2,}/g, " ").trim().toLowerCase();
    };

    const renderChunkedText = (htmlContent, showChunks) => {
      if (!showChunks) return <InteractiveSentence htmlContent={htmlContent} />;
      const parts = htmlContent.split(/(<[^>]+>)/g);
      const chunkedElements = parts.map((part) => {
        if (part.startsWith('<')) return part;
        return part.replace(/([,.;?])/g, "$1<span class='chunk-separator'>|</span>")
                   .replace(/\s(and|but|or|because|that|which|where|when)\s/gi, " <span class='chunk-separator'>|</span> $1 ");
      });
      return <InteractiveSentence htmlContent={chunkedElements.join('')} />;
    };

    const InteractiveSentence = ({ htmlContent, isBlindMode }) => {
      const regex = /(<span class='[^']+'>.*?<\/span>)|([^<]+)/g;
      const parts = htmlContent.match(regex) || [];
      const handleWordClick = (e, word) => {
        e.stopPropagation();
        const cleanWord = word.replace(/[.,?!:;|]/g, '');
        if(cleanWord.trim()) speakText(cleanWord, 0.75);
      };
      return (
        <span className={`leading-relaxed transition-all duration-500 ${isBlindMode ? 'blind-mode-blur' : ''}`}>
          {parts.map((part, index) => {
            if (part.startsWith('<span')) {
              const classMatch = part.match(/class='([^']+)'/);
              const className = classMatch ? classMatch[1] : '';
              const contentMatch = part.match(/>(.*?)</);
              const content = contentMatch ? contentMatch[1] : '';
              if (className.includes('chunk-separator')) return <span key={index} className={className} dangerouslySetInnerHTML={{__html: content}}></span>
              const words = content.split(' ');
              return (
                <span key={index} className={className}>
                  {words.map((word, wIndex) => (
                    <React.Fragment key={wIndex}>
                      <span className="cursor-pointer hover:bg-yellow-200 hover:text-black rounded px-0.5 transition-colors active:scale-95 inline-block" onClick={(e) => handleWordClick(e, word)}>{word}</span>
                      {wIndex < words.length - 1 && ' '}
                    </React.Fragment>
                  ))}
                </span>
              );
            } else {
              const words = part.split(' ');
              return <span key={index}>{words.map((word, wIndex) => <React.Fragment key={wIndex}><span className="cursor-pointer hover:bg-yellow-200 hover:text-black rounded px-0.5 transition-colors active:scale-95 inline-block" onClick={(e) => handleWordClick(e, word)}>{word}</span>{wIndex < words.length - 1 && ' '}</React.Fragment>)}</span>;
            }
          })}
        </span>
      );
    };

    const RenderComparison = ({ feedback }) => {
       if (!feedback || !feedback.spokenText) return null;
       const targetWords = cleanText(feedback.targetText).split(' ');
       const spokenWords = cleanText(feedback.spokenText).split(' ');
       return (
          <div className="mt-2 text-sm bg-white p-3 rounded border border-gray-200 shadow-inner">
             {feedback.advice && (
                <div className="mb-2 pb-2 border-b border-gray-100 bg-yellow-50 p-2 rounded">
                   <div className="text-yellow-700 text-xs font-bold mb-1 flex items-center"><Lightbulb className="w-3 h-3 mr-1" />教練的發音診斷：</div>
                   <div className="text-gray-700 text-sm font-medium">{feedback.advice}</div>
                </div>
             )}
            <div className="mb-1 text-gray-500 text-xs">辨識結果比對 (嚴格模式)：</div>
            <div className="mb-2">
              {targetWords.map((word, idx) => {
                const isMatch = spokenWords.some(sw => sw === word || (sw.length > 3 && (sw.includes(word) || word.includes(sw))));
                return <span key={idx} className={`mr-1 ${isMatch ? 'word-correct' : 'word-missed'}`}>{word}</span>;
              })}
            </div>
            <div className="mt-1 text-xs text-gray-400">(我聽到: <span className="text-gray-600 italic">{feedback.spokenText}</span>)</div>
          </div>
       );
    };

    const MobileFeedbackToast = ({ feedback, showDetails, toggleDetails, onClose }) => {
       if (!feedback) return null;
       const portalRoot = document.getElementById('feedback-portal-root');
       if (!portalRoot) return null;
       return createPortal(
          <div className={`md:hidden fixed bottom-0 left-0 right-0 z-[99999] p-4 pb-8 rounded-t-2xl shadow-[0_-8px_40px_rgba(0,0,0,0.3)] border-t transition-transform duration-300 animate-slide-up-bounce bg-white ${feedback.type === 'success' ? 'border-green-400 bg-green-50 ring-4 ring-green-100' : feedback.type === 'warning' ? 'border-yellow-300 bg-yellow-50' : feedback.type === 'error' ? 'border-red-300 bg-red-50' : 'border-blue-300 bg-blue-50'}`}>
             <div className="flex items-center justify-between gap-2 mb-2">
                <div className="flex items-center gap-2 overflow-hidden">
                   {feedback.type === 'success' && <Check className="w-6 h-6 text-green-600 flex-shrink-0 animate-bounce"/>}
                   {feedback.type === 'warning' && <AlertCircle className="w-6 h-6 text-yellow-600 flex-shrink-0"/>}
                   {feedback.type === 'error' && <X className="w-6 h-6 text-red-600 flex-shrink-0"/>}
                   <span className={`font-bold text-lg truncate ${feedback.type === 'success' ? 'text-green-800' : 'text-slate-800'}`}>{feedback.text} {feedback.score !== undefined && `(${feedback.score}%)`}</span>
                </div>
                <div className="flex gap-2 flex-shrink-0">
                   {feedback.spokenText && <button onClick={toggleDetails} className="px-4 py-2 bg-white rounded-full text-sm font-bold shadow-sm border border-gray-100 active:bg-gray-100 transition-all text-slate-700">{showDetails ? '隱藏' : '詳情'}</button>}
                   <button onClick={onClose} className="w-9 h-9 flex items-center justify-center bg-white rounded-full text-gray-400 hover:text-red-500 shadow-sm border border-gray-100 active:bg-gray-100 transition-all"><X className="w-5 h-5" /></button>
                </div>
             </div>
             {showDetails && <div className="max-h-[50vh] overflow-y-auto overscroll-contain pb-2 mt-3 bg-white/50 rounded-xl p-2 animate-fade-in"><RenderComparison feedback={feedback} /></div>}
          </div>, portalRoot 
       );
    };

    const VoiceEvaluatorButton = ({ id, status, feedback, showDetails, toggleDetails, onRecord }) => {
      let buttonClass = "bg-white text-gray-500 border-gray-200 hover:bg-gray-50 hover:text-blue-600";
      let icon = <Mic className="w-5 h-5" />;
      if (status === 'init') { buttonClass = "bg-yellow-100 text-yellow-600 border-yellow-300"; icon = <Loader2 className="w-5 h-5 animate-spin-slow" />; } 
      else if (status === 'listening') { buttonClass = "bg-red-500 text-white border-red-500 animate-pulse-red"; icon = <div className="text-xs font-bold font-sans">GO!</div>; }
      return (
        <div className="relative inline-block ml-2 text-left">
          <button onClick={(e) => { e.stopPropagation(); onRecord(id); }} className={`flex items-center justify-center w-10 h-10 rounded-full border shadow-sm transition-all ${buttonClass}`} title="點擊開始錄音 (嚴格模式)">{icon}</button>
          {status === 'init' && <div className="absolute top-full left-1/2 -translate-x-1/2 mt-1 text-[10px] text-yellow-600 font-bold whitespace-nowrap">準備中...</div>}
          {feedback && (
            <div className={`hidden md:block absolute top-full right-0 mt-2 p-3 rounded-lg text-sm font-bold whitespace-normal min-w-[300px] z-30 shadow-xl border animate-fade-in ${feedback.type === 'success' ? 'bg-green-50 text-green-800 border-green-200' : feedback.type === 'warning' ? 'bg-yellow-50 text-yellow-800 border-yellow-200' : feedback.type === 'error' ? 'bg-red-50 text-red-800 border-red-200' : 'bg-blue-50 text-blue-800 border-blue-200'}`}>
              <div className="flex items-center justify-between gap-2">
                <div className="flex items-center gap-2">
                   {feedback.type === 'success' && <Check className="w-4 h-4 text-green-600"/>}
                   {feedback.type === 'warning' && <AlertCircle className="w-4 h-4 text-yellow-600"/>}
                   {feedback.type === 'error' && <X className="w-4 h-4 text-red-600"/>}
                   <span className="font-medium">{feedback.text} {feedback.score !== undefined && `(${feedback.score}%)`}</span>
                </div>
                {feedback.spokenText && <button onClick={(e) => { e.stopPropagation(); toggleDetails(); }} className="text-xs underline opacity-70 hover:opacity-100">{showDetails ? '隱藏' : '詳情'}</button>}
              </div>
              {showDetails && <RenderComparison feedback={feedback} />}
            </div>
          )}
        </div>
      );
    };

    const VocabCard = ({ item, colorTheme, onDelete }) => {
       const themes = {
        blue: { bg: "bg-blue-50", border: "border-blue-200", text: "text-blue-800", badge: "bg-blue-100 text-blue-700", icon: "text-blue-500", btn: "bg-blue-600 hover:bg-blue-700" },
        green: { bg: "bg-green-50", border: "border-green-200", text: "text-green-800", badge: "bg-green-100 text-green-700", icon: "text-green-500", btn: "bg-green-600 hover:bg-green-700" },
        amber: { bg: "bg-amber-50", border: "border-amber-200", text: "text-amber-800", badge: "bg-amber-100 text-amber-700", icon: "text-amber-500", btn: "bg-amber-600 hover:bg-amber-700" },
        purple: { bg: "bg-purple-50", border: "border-purple-200", text: "text-purple-800", badge: "bg-purple-100 text-purple-700", icon: "text-purple-500", btn: "bg-purple-600 hover:bg-purple-700" }, 
        teal: { bg: "bg-teal-50", border: "border-teal-200", text: "text-teal-800", badge: "bg-teal-100 text-teal-700", icon: "text-teal-500", btn: "bg-teal-600 hover:bg-teal-700" },
        indigo: { bg: "bg-indigo-50", border: "border-indigo-200", text: "text-indigo-800", badge: "bg-indigo-100 text-indigo-700", icon: "text-indigo-500", btn: "bg-indigo-600 hover:bg-indigo-700" },
        orange: { bg: "bg-orange-50", border: "border-orange-200", text: "text-orange-800", badge: "bg-orange-100 text-orange-700", icon: "text-orange-500", btn: "bg-orange-600 hover:bg-orange-700" },
        red: { bg: "bg-red-50", border: "border-red-200", text: "text-red-800", badge: "bg-red-100 text-red-700", icon: "text-red-500", btn: "bg-red-600 hover:bg-red-700" },
      };
      const theme = themes[colorTheme] || themes.blue;
      return (
        <div onClick={() => speakText(item.word)} className={`relative flex flex-col justify-between p-5 rounded-xl border-2 ${theme.bg} ${theme.border} shadow-sm hover:shadow-md transition-all cursor-pointer group hover:-translate-y-1 h-full`}>
          <div className="flex justify-between items-start mb-3">
            <div><h3 className="text-xl font-bold text-gray-800 group-hover:text-black tracking-wide">{item.word}</h3><span className="text-sm font-medium text-gray-600 block mt-1">{item.mean}</span></div>
            <button className={`w-8 h-8 rounded-full flex items-center justify-center text-white shadow-sm transition-transform group-hover:scale-110 ${theme.btn}`}><Volume2 className="w-4 h-4" /></button>
          </div>
          <div className="space-y-3 mt-auto">
            <div className={`inline-block px-2 py-1 rounded-md text-xs font-bold font-mono ${theme.badge} opacity-90`}>{item.kk}</div>
            <div className="text-xs text-gray-600 flex items-start bg-white/60 p-2 rounded-lg backdrop-blur-sm relative"><Info className={`w-3 h-3 mr-1.5 mt-0.5 flex-shrink-0 ${theme.icon}`} /><span className="flex-1 leading-snug">{item.tip}</span></div>
          </div>
        </div>
      );
    };

    const StartScreen = ({ onStart }) => {
      return (
        <div className="fixed inset-0 z-[9999] bg-slate-900 flex flex-col overflow-y-auto">
          <div className="min-h-full flex flex-col items-center justify-center p-4">
             <div className="max-w-md w-full bg-slate-800 rounded-3xl p-6 md:p-8 shadow-2xl border border-slate-700 text-center relative overflow-hidden my-auto">
                <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>
                <div className="w-16 h-16 md:w-20 md:h-20 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4 md:mb-6 text-blue-400 ring-4 ring-slate-600/50"><i className="fas fa-headset text-3xl md:text-4xl"></i></div>
                <h1 className="text-2xl md:text-3xl font-bold mb-3 tracking-tight text-white">商務英語會話特訓</h1>
                <p className="text-slate-400 mb-6 text-sm leading-relaxed">為了確保最佳的練習體驗，我們需要先取得您的麥克風權限。<br/><br/><span className="text-blue-300 font-medium bg-blue-900/30 px-2 py-1 rounded">點擊一次允許，全程無縫練習</span></p>
                <button onClick={onStart} className="group w-full relative inline-flex items-center justify-center px-6 py-3 md:px-8 md:py-4 text-base md:text-lg font-bold text-white transition-all duration-200 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg hover:shadow-blue-500/30 active:scale-95"><span>開啟麥克風並開始</span><div className="ml-3 flex items-center gap-1 h-4"><div className="wave-bar"></div><div className="wave-bar"></div><div className="wave-bar"></div></div></button>
                <p className="mt-6 text-xs text-slate-500"><i className="fas fa-shield-alt mr-1"></i> 您的隱私受保護，錄音僅在瀏覽器內處理</p>
             </div>
          </div>
        </div>
      );
    };

    const initialVocabSections = [
        { title: "Unit 1: 求職面試 (1-12)", unitId: "Unit 1", desc: "基礎單字 Part A", color: "blue", icon: Briefcase,
          words: [ { word: "Interview", kk: "[ˈɪntɚˌvju]", mean: "面試", tip: "重音在最前。中間 t 常被吞掉，唸 Inner-view。" }, { word: "Employer", kk: "[ɪmˈplɔɪɚ]", mean: "雇主", tip: "重音在第二音節 ploy。" }, { word: "Pleasure", kk: "[ˈplɛʒɚ]", mean: "榮幸", tip: "s 發 [ʒ] (類似「熱」的捲舌音)，勿唸 sure。" }, { word: "Hire", kk: "[haɪr]", mean: "雇用", tip: "完整發出字尾 r 的捲舌音。" }, { word: "Role-playing", kk: "[rol ˈpleɪɪŋ]", mean: "角色扮演", tip: "Role 嘴型要圓，唸起來像 Row (划船)。" }, { word: "Aligned", kk: "[əˈlaɪnd]", mean: "一致/符合", tip: "gn 不發音，只發 line，字尾 d 輕點。" }, { word: "Progressive", kk: "[prəˈgrɛsɪv]", mean: "連續/累積的", tip: "重音在中間 gre，嘴巴張大。" }, { word: "Hospitality", kk: "[ˌhɑspɪˈtæləti]", mean: "觀光/好客", tip: "重音在 ta。唸 Hos-pi-TA-li-ty。" }, { word: "Initial", kk: "[ɪˈnɪʃəl]", mean: "最初的", tip: "ti 發 [ʃ] (許) 的音。" }, { word: "Associate", kk: "[əˈsoʃɪɪt]", mean: "助理/夥伴", tip: "ci 發 [ʃ] (許)。字尾 ate 唸短音 [ɪt]。" }, { word: "Concierge", kk: "[ˌkɑnsɪˈɛrʒ]", mean: "禮賓接待員", tip: "法文外來語，重音在後。ge 發 [ʒ]。" }, { word: "Concise", kk: "[kənˈsaɪs]", mean: "簡潔的", tip: "cise 唸起來像 size，重音在後。" } ] },
        { title: "Unit 1: 求職面試 (13-24)", unitId: "Unit 1", desc: "基礎單字 Part B", color: "green", icon: Feather,
          words: [ { word: "Thoroughly", kk: "[ˈθɝroli]", mean: "徹底地", tip: "th 輕咬舌尖吐氣，馬上接 r 捲舌。" }, { word: "The Lalu", kk: "[ðə ˈlalu]", mean: "涵碧樓", tip: "專有名詞，發音輕鬆清楚即可。" }, { word: "Demanding", kk: "[dɪˈmændɪŋ]", mean: "要求高的", tip: "重音在 man，發蝴蝶音 [æ]。" }, { word: "Stressful", kk: "[ˈstrɛsfəl]", mean: "有壓力的", tip: "兩個 s 都要清楚，中間 t 別漏。" }, { word: "Meditation", kk: "[ˌmɛdəˈteʃən]", mean: "冥想", tip: "重音在 ta。前面是 Medi (麥迪)。" }, { word: "Specific", kk: "[spɪˈsɪfɪk]", mean: "具體的", tip: "重音在中間 ci。" }, { word: "Focus", kk: "[ˈfokəs]", mean: "專注", tip: "o 發雙母音 [oʊ]，嘴形要有「歐-烏」的滑動。" }, { word: "Appeal", kk: "[əˈpil]", mean: "吸引/訴求", tip: "ea 發長音 [i]，尾音 l 舌尖頂上顎。" }, { word: "Apply", kk: "[əˈplaɪ]", mean: "申請", tip: "重音在後面 ply。" }, { word: "Mind", kk: "[maɪnd]", mean: "心智/介意", tip: "字尾 nd 的鼻音要發出來。" }, { word: "Industry", kk: "[ˈɪndəstri]", mean: "產業", tip: "注意！重音在第一音節 In。" }, { word: "Contraction", kk: "[kənˈtrækʃən]", mean: "縮讀/縮寫", tip: "重音在 trac，發蝴蝶音 [æ]。" } ] },
        { title: "Unit 2: 商務參展 (1-12)", unitId: "Unit 2", desc: "基礎單字 Part A", color: "amber", icon: Layout,
          words: [ { word: "Exhibition", kk: "[ˌɛksəˈbɪʃən]", mean: "展覽", tip: "ex 唸 [ɛks]；h 不發音；重音在 bi。" }, { word: "Booth", kk: "[buθ]", mean: "展位/攤位", tip: "字尾 th 舌頭伸出輕咬吐氣，別唸成 s。" }, { word: "Address", kk: "[əˈdrɛs]", mean: "稱呼/演說", tip: "動詞時重音在第二音節 dress。" }, { word: "Brief", kk: "[brif]", mean: "簡介", tip: "長音 [i]；字尾 f 咬下唇吐氣。" }, { word: "Linear", kk: "[ˈlɪnɪɚ]", mean: "線型的", tip: "重音在最前 Li；唸 Li-nee-er。" }, { word: "Corner", kk: "[ˈkɔrnɚ]", mean: "角落/轉角", tip: "or 捲舌音要出來；不要唸 Cona。" }, { word: "Peninsula", kk: "[pəˈnɪnsələ]", mean: "半島型展位", tip: "重音在 nin。唸 Puh-NIN-suh-la。" }, { word: "Island", kk: "[ˈaɪlənd]", mean: "中島型展位", tip: "注意 s 不發音！唸 Eye-land。" }, { word: "Option", kk: "[ˈɑpʃən]", mean: "選項", tip: "Op 發 [ɑ] (張大嘴)；tion 發 [ʃən]。" }, { word: "Budget", kk: "[ˈbʌdʒɪt]", mean: "預算", tip: "u 發短音 [ʌ]；dg 發 [dʒ]，別唸 Ba-get。" }, { word: "Terms", kk: "[tɝmz]", mean: "條款/方面", tip: "er 捲舌長一點；字尾 ms 有鼻音震動。" }, { word: "Dimension", kk: "[dɪˈmɛnʃən]", mean: "尺寸/面積", tip: "重音在 men；sion 發 [ʃən]。" } ] },
        { title: "Unit 2: 商務參展 (13-25)", unitId: "Unit 2", desc: "基礎單字 Part B", color: "purple", icon: MapPin,
          words: [ { word: "Package", kk: "[ˈpækɪdʒ]", mean: "套裝方案", tip: "重音 Pac 发 [æ]；age 唸 [ɪdʒ]。" }, { word: "Comprise", kk: "[kəmˈpraɪz]", mean: "包含", tip: "重音在後 prise；pri 發 [praɪ]。" }, { word: "Signboard", kk: "[ˈsaɪnˌbɔrd]", mean: "看板", tip: "複合字重音在前。g 不發音。" }, { word: "Partition", kk: "[pɑrˈtɪʃən]", mean: "隔板", tip: "重音在 ti；par 的 ar 要捲舌。" }, { word: "Straight", kk: "[stret]", mean: "直的", tip: "gh 不發音。唸起來像 A 的長音。" }, { word: "Surrounded", kk: "[səˈraʊndɪd]", mean: "被環繞的", tip: "重音在 roun，發 [aʊ] 音。" }, { word: "Proceed", kk: "[prəˈsid]", mean: "繼續進行", tip: "重音在後 ceed，長音 [i]。" }, { word: "VAT", kk: "[vi e ti]", mean: "加值稅", tip: "直接唸字母 V-A-T。" }, { word: "Exhibitor", kk: "[ɪgˈzɪbɪtɚ]", mean: "參展商", tip: "重音轉移到第二音節 zi；h 不發音。" }, { word: "Application", kk: "[ˌæpləˈkeʃən]", mean: "申請", tip: "重音在 ca；前 app 發蝴蝶音 [æ]。" }, { word: "Available", kk: "[əˈveləb!]", mean: "可用的", tip: "重音在 vai (欸)；ble 輕唸。" }, { word: "Offer", kk: "[ˈɔfɚ]", mean: "提供", tip: "開頭 o 發 [ɔ] (嘴呈 O 型)。" }, { word: "Arrange", kk: "[əˈrendʒ]", mean: "安排", tip: "重音在後 range；字尾 ge 發 [dʒ]。" } ] },
        { title: "Unit 3: 參展會議 (1-12)", unitId: "Unit 3", desc: "基礎單字 Part A", color: "teal", icon: MessageCircle,
          words: [ { word: "Discuss", kk: "[dɪˈskʌs]", mean: "討論", tip: "重音在後 scuss。字尾 ss 的氣音要長一點。" }, { word: "Suggestion", kk: "[səˈdʒɛstʃən]", mean: "建議", tip: "重音在 ges。ges 發 [dʒɛs] (傑)。" }, { word: "Peninsula", kk: "[pəˈnɪnsələ]", mean: "半島", tip: "重音在 nin。唸 Puh-NIN-suh-la。" }, { word: "Keen", kk: "[kin]", mean: "熱衷於", tip: "長音 [i]，嘴角要往兩邊拉開微笑。" }, { word: "Bulky", kk: "[ˈbʌlkɪ]", mean: "笨重的", tip: "[ʌ] 短音。l 的音要含在喉嚨裡。" }, { word: "Potential", kk: "[pəˈtɛnʃəl]", mean: "潛在的", tip: "重音在 ten。ti 發 [ʃ] (許) 的音。" }, { word: "Linger", kk: "[ˈlɪŋgɚ]", mean: "逗留", tip: "ng 發 [ŋg] (嗯-葛)，後面有 g 的聲音。" }, { word: "Inviting", kk: "[ɪnˈvaɪtɪŋ]", mean: "誘人的", tip: "重音在 vi。注意 v 要咬下唇震動。" }, { word: "Invaluable", kk: "[ɪnˈvæljʊəb!]", mean: "無價的", tip: "重音在 va。注意 l 接 u 的滑音。" }, { word: "Sufficient", kk: "[səˈfɪʃənt]", mean: "足夠的", tip: "重音在 fi。ci 發 [ʃ] (許)。" }, { word: "Cramped", kk: "[kræmpt]", mean: "擁擠的", tip: "蝴蝶音 [æ]。字尾 mp 嘴巴閉緊再吐氣接 t。" }, { word: "Spacious", kk: "[ˈspeʃəs]", mean: "寬敞的", tip: "ci 發 [ʃ] (許)。唸 Spei-shus。" } ] },
        { title: "Unit 3: 參展會議 (13-25)", unitId: "Unit 3", desc: "基礎單字 Part B", color: "orange", icon: Lightbulb,
          words: [ { word: "Comfortable", kk: "[ˈkʌmfɚtəb!]", mean: "舒適的", tip: "重音在第一音節！口語常唸 Comf-ta-ble。" }, { word: "Launch", kk: "[lɔntʃ]", mean: "發布/推出", tip: "[ɔ] 嘴巴成 O 型。字尾 ch 要短促有力。" }, { word: "Display", kk: "[dɪˈsple]", mean: "展示", tip: "重音在後 play。" }, { word: "Feature", kk: "[ˈfitʃɚ]", mean: "特色", tip: "fea 發長音 [i]；ture 發 [tʃɚ] (徹)。" }, { word: "Station", kk: "[ˈsteʃən]", mean: "安置/駐紮", tip: "tion 發 [ʃən]。" }, { word: "Occupy", kk: "[ˈɑkjəˌpaɪ]", mean: "佔據", tip: "重音在前 O。cu 發 [kjə]。" }, { word: "Second", kk: "[ˈsɛkənd]", mean: "附議", tip: "會議用語。重音在 se。" }, { word: "Winner", kk: "[ˈwɪnɚ]", mean: "贏家/首選", tip: "短音 [ɪ]，嘴形放鬆。" }, { word: "Input", kk: "[ˈɪnˌpʊt]", mean: "意見/投入", tip: "重音在 In。put 發短音 [ʊ]。" }, { word: "Decision", kk: "[dɪˈsɪʒən]", mean: "決定", tip: "si 發 [ʒ] (日) 的震動音，非 [ʃ]。" }, { word: "Catch", kk: "[kætʃ]", mean: "聽清楚", tip: "蝴蝶音 [æ]。字尾 ch 清楚。" }, { word: "Comfy", kk: "[ˈkʌmfɪ]", mean: "舒適的(口語)", tip: "Comfortable 的簡稱。mf 連唸。" }, { word: "Trade show", kk: "[tred ʃo]", mean: "貿易展", tip: "tr 要唸得像 ㄔㄨ (chu) 的氣音。" } ] },
        { title: "Unit 4: 設備檢查 (1-11)", unitId: "Unit 4", desc: "基礎單字 Part A", color: "indigo", icon: Wifi,
          words: [ { word: "Held", kk: "[hɛld]", mean: "舉行", tip: "尾音 ld 要輕，舌尖頂住上顎，勿唸 hel-do。" }, { word: "Ma'am", kk: "[mæm]", mean: "女士", tip: "扁平母音 [æ]。madam 的縮讀。" }, { word: "Venue", kk: "[ˈvɛnju]", mean: "場地", tip: "字尾 [u] 要噘嘴，發音像 V-N-U。" }, { word: "U-shaped", kk: "[ˈjuˌʃept]", mean: "馬蹄形的", tip: "尾音 t 要輕促。連字號要連讀。" }, { word: "Laptop", kk: "[ˈlæpˌtɑp]", mean: "筆電", tip: "中間 p 不用噴氣(閉氣)，直接接 top。" }, { word: "Access", kk: "[ˈæksɛs]", mean: "存取/連接", tip: "重音在第一音節。兩個 s 都要清晰。" }, { word: "Wireless", kk: "[ˈwaɪrlɪs]", mean: "無線的", tip: "less 發音短促，不要念成 lace。" }, { word: "Password", kk: "[ˈpæsˌwɝd]", mean: "密碼", tip: "pass 扁嘴。word 捲舌像 were。" }, { word: "Built-in", kk: "[ˈbɪltˌɪn]", mean: "內建的", tip: "連讀時聽起來像 bil-tin。" }, { word: "Scan", kk: "[skæn]", mean: "掃描", tip: "sk 的 k 不送氣，發成類似「ㄍ」。" }, { word: "Eco-friendly", kk: "[ˌikoˈfrɛndlɪ]", mean: "環保的", tip: "friendly 的 d 不發音，唸 fren-li。" } ] },
        { title: "Unit 4: 設備檢查 (12-21)", unitId: "Unit 4", desc: "基礎單字 Part B", color: "blue", icon: Settings,
          words: [ { word: "Wiring", kk: "[ˈwaɪrɪŋ]", mean: "線路", tip: "wire + ing。中間 [r] 要滑順。" }, { word: "Port", kk: "[pɔrt]", mean: "連接埠", tip: "母音 [ɔ] 嘴巴圓，最後加上捲舌 rt。" }, { word: "Rehearsed", kk: "[rɪˈhɝst]", mean: "排練", tip: "hear 發 [hɝ] 捲舌。字尾 ed 發 [t]。" }, { word: "Pinpoint", kk: "[ˈpɪnˌpɔɪnt]", mean: "精確指出", tip: "兩個 p 都要噴氣。oi 滑動明顯。" }, { word: "Audio", kk: "[ˈɔdɪˌo]", mean: "音訊", tip: "開頭 [ɔ] 圓嘴。結尾 [o] 也要圓嘴。" }, { word: "Stitch", kk: "[stɪtʃ]", mean: "一針", tip: "[ɪ] 短音。tch 發 [tʃ]。" }, { word: "Facilities", kk: "[fəˈsɪlətɪz]", mean: "設施", tip: "重音在 ci [sɪ]。" }, { word: "Laser pointer", kk: "[ˈlezɚ ˌpɔɪntɚ]", mean: "雷射筆", tip: "laser 的 s 發 [z]。er 都要捲舌。" }, { word: "Flattered", kk: "[ˈflætɚd]", mean: "受寵若驚", tip: "中間 tt 發輕快彈舌音 [d]。" }, { word: "Superb", kk: "[sʊˈpɝb]", mean: "極好的", tip: "重音在後。su 發 [sʊ] (書)。" } ] },
        { title: "Unit 5: 差旅核銷 (1-10)", unitId: "Unit 5", desc: "Reimbursement Policy Part A", color: "red", icon: CreditCard,
          words: [ { word: "Reimbursement", kk: "[͵riɪmˋbɝsmənt]", mean: "核銷；報帳", tip: "★難字挑戰。重音在 bur。注意 re-im-burse-ment 四個音節清楚。中間的 [m] 和 [b] 嘴巴都要確實閉起來。" }, { word: "Keynote speaker", kk: "[ˋki͵not ˋspikɚ]", mean: "主講人", tip: "Keynote 的 [o] 是長母音，嘴型要圓且凸。Speaker 的 [sp] 不送氣，聽起來像「ㄅ」。" }, { word: "Policy", kk: "[ˋpɑləsɪ]", mean: "政策", tip: "注意重音在第一音節。[l] 舌尖要頂住上排牙齒後方。" }, { word: "Subsistence", kk: "[səbˋsɪstəns]", mean: "生存；生活", tip: "[b] 緊接 [s]，嘴唇閉一下立刻接絲絲聲。唸起來像 sub-sis-tence。" }, { word: "Expenditure", kk: "[ɪkˋspɛndɪtʃɚ]", mean: "支出；花費", tip: "重音在 pen。[tʃɚ] 嘴巴要嘟起來，發出類似「去ㄦ」的捲舌音。" }, { word: "Accommodation", kk: "[ə͵kɑməˋdeʃən]", mean: "住宿", tip: "雙母音 [m] 出現兩次，嘴唇要閉緊。重音在 de。" }, { word: "Allowance", kk: "[əˋlaʊəns]", mean: "津貼；零用錢", tip: "[aʊ] 是大口音（如 ouch），嘴巴要張大再縮圓。" }, { word: "Receipt", kk: "[rɪˋsit]", mean: "收據", tip: "超級易錯！中間的 p 是不發音的。唸起來像 re-seat。" }, { word: "Incur", kk: "[ɪnˋkɝ]", mean: "招致；產生(費用)", tip: "[kɝ] 是捲舌長音，像 bird 的音。" }, { word: "Spouse", kk: "[spaʊs]", mean: "配偶", tip: "[sp] 唸「ㄅ」的音。[aʊ] 嘴巴張大。尾音 [s] 氣音要輕。" } ] },
        { title: "Unit 5: 差旅核銷 (11-20)", unitId: "Unit 5", desc: "Reimbursement Policy Part B", color: "amber", icon: Briefcase,
          words: [ { word: "Accompany", kk: "[əˋkʌmpənɪ]", mean: "陪同；伴隨", tip: "重音在 cum。[m] 接 [p] 是標準雙唇音練習，嘴唇閉緊再爆開。" }, { word: "Itinerary", kk: "[aɪˋtɪnə͵rɛrɪ]", mean: "行程表", tip: "[aɪ] 發音飽滿。注意音節多，慢慢唸 i-tin-e-rar-y。" }, { word: "Submit", kk: "[səbˋmɪt]", mean: "呈交；提交", tip: "[b] 接 [m]，這是講義重點！嘴唇閉一次即可，不用分開唸 sub-mit，而是順著氣流帶過。" }, { word: "Regulation", kk: "[͵rɛgjəˋleʃən]", mean: "規定", tip: "[g] 接 [j] 要滑順。重音在 la。" }, { word: "Sufficient", kk: "[səˋfɪʃənt]", mean: "充足的", tip: "[ʃ] 是噓聲，嘴巴嘟圓。" }, { word: "Economy class", kk: "[ɪˋkɑnəmɪ klæs]", mean: "經濟艙", tip: "Economy 重音在 co。Class 的 [æ] 是蝴蝶音，嘴巴要向兩側咧開。" }, { word: "Business class", kk: "[ˋbɪznɪs klæs]", mean: "商務艙", tip: "Business 只有兩個音節 [ˋbɪz-nɪs]，不要唸成 busy-ness。" }, { word: "Original", kk: "[əˋrɪdʒən!]", mean: "正本的；原始的", tip: "[dʒ] 嘴巴嘟起震動。結尾 [l] 舌尖頂上顎，喉嚨發出模糊音。" }, { word: "High-speed rail", kk: "[haɪ spid rel]", mean: "高鐵", tip: "Rail 的 [r] 嘴型圓，結尾 [l] 舌尖上頂。" }, { word: "Invitation", kk: "[͵ɪnvəˋteʃən]", mean: "邀請(函)", tip: "[v] 上排牙齒咬下唇震動。重音在 ta。" } ] },
        { title: "Unit 6: 緊急變更 (1-10)", unitId: "Unit 6", desc: "Emergency Change Part A", color: "red", icon: AlertTriangle,
          words: [ { word: "Urgent", kk: "[ˋɝdʒənt]", mean: "緊急的", tip: "重音在首。Ur- 要捲舌發 [ɝ]，gent 的 [dʒ] 嘴巴要嘟起來震動。" }, { word: "Terrorist", kk: "[ˋtɛrərɪst]", mean: "恐怖份子", tip: "重音在第一音節。注意中間的 ro 是弱音，rist 結尾的 [st] 輕輕收尾。" }, { word: "Stockholm", kk: "[ˋstɑk͵hom]", mean: "斯德哥爾摩", tip: "[st] 不送氣重點！唸成 Stock-home。 [l] 幾乎不發音或很輕。" }, { word: "Hijacked", kk: "[ˋhaɪdʒækt]", mean: "被劫持的", tip: "複合字 High-jacked。注意字尾 [k] 是無聲，所以 -ed 會發成 [t] 的音。" }, { word: "British", kk: "[ˋbrɪtɪʃ]", mean: "英國的", tip: "[br] 雙唇震動快。結尾 [ʃ] 是「噓」的聲音，嘴巴要圓。" }, { word: "Belgian", kk: "[ˋbɛldʒən]", mean: "比利時的", tip: "重音在 Bel。注意 [dʒ] 的音，不要唸成 [g]。" }, { word: "Terrified", kk: "[ˋtɛrə͵faɪd]", mean: "嚇壞了", tip: "第一音節重音。fied 包含雙母音 [aɪ]，嘴巴要張開。" }, { word: "Traumatic", kk: "[traʊˋmætɪk]", mean: "創傷的", tip: "[aʊ] 是大口音（像 ouch）。重音在 ma，嘴巴向兩側咧開 (蝴蝶音 [æ])。" }, { word: "Frustration", kk: "[frʌˋstreʃən]", mean: "挫折；沮喪", tip: "[str] 不送氣重點！[t] 轉音似「ㄉ」。唸起來像 frus-dray-shun。" }, { word: "Struggle", kk: "[ˋstrʌg!]", mean: "掙扎；努力", tip: "[str] 不送氣重點。結尾 [g!] 是喉嚨發出的模糊音，舌尖頂上顎。" } ] },
        { title: "Unit 6: 緊急變更 (11-20)", unitId: "Unit 6", desc: "Emergency Change Part B", color: "orange", icon: AlertTriangle,
          words: [ { word: "Student", kk: "[ˋstjudnt]", mean: "學生", tip: "[st] 不送氣重點。不要噴氣，唸起來像「斯丟等」。" }, { word: "Start", kk: "[stɑrt]", mean: "開始", tip: "[st] 不送氣重點。[ar] 要發飽滿的捲舌長音。" }, { word: "Stable", kk: "[ˋsteb!]", mean: "穩定的", tip: "[st] 不送氣重點。唸起來像「stay-ball」。" }, { word: "Replace", kk: "[rɪˋples]", mean: "取代；接替", tip: "Re 輕讀。Place 的 [p] 要送氣（噴氣），尾音 [s] 氣長。" }, { word: "Notice", kk: "[ˋnotɪs]", mean: "通知；注意", tip: "重音在 No。[o] 嘴型要圓。tice 的 [s] 輕聲。" }, { word: "Paris", kk: "[ˋpærɪs]", mean: "巴黎", tip: "重音在 Pa。注意 [æ] 是蝴蝶音。字尾 [s] 要發出來（不像法文）。" }, { word: "Barcelona", kk: "[͵bɑrsəˋlonə]", mean: "巴塞隆納", tip: "音節多，慢慢唸 Bar-ce-lo-na。Lo 是重音，嘴巴要圓。" }, { word: "Local", kk: "[ˋlok!]", mean: "當地的", tip: "[o] 發音要足。cal 發 [k!]，舌尖頂住上排牙齒後方發聲。" }, { word: "Owe", kk: "[o]", mean: "虧欠", tip: "只有一個母音 [o]。嘴巴嘟圓，像唸英文字母 O。" }, { word: "Minute", kk: "[ˋmɪnɪt]", mean: "分鐘", tip: "注意發音是 [ˋmɪnɪt]，不是 my-nute。i 發短母音 [ɪ]。" } ] }
      ];
    // --- SENTENCE DATA ---
    const initialInterviewData = [
        { id: 1, category: "Unit 1: 開場與請求協助", unitId: "Unit 1", desc: "A. Opening & Request", colorTheme: "blue", icon: MessageCircle,
          sentences: [
            { id: "u1-1", type: "Intro", text: "Hi, can you <span class='highlight-kw'>help me with</span> my job interview?", plain: "Hi, can you help me with my job interview?", mean: "嗨，你能幫幫我練習求職面試嗎？", tip: "help me 中間 p 很輕；interview 重音在最前。", traps: { "job": "Job 的母音 [ɑ] 嘴巴要張大，唸成 jab (猛刺) 是錯誤的。" } },
            { id: "u1-2", type: "Reply", text: "My pleasure. How do you <span class='highlight-kw'>want me to</span> help?", plain: "My pleasure. How do you want me to help?", mean: "我的榮幸。你要我怎麼幫呢？", tip: "want me to 口語常弱化唸成 wanna。", traps: { "pleasure": "Pleasure 的 s 要發 [ʒ]，不要唸成 please。" } },
            { id: "u1-3", type: "Request", text: "How about asking me some questions <span class='highlight-kw'>like an</span> employer?", plain: "How about asking me some questions like an employer?", mean: "模擬一些雇主可能會問的問題，好嗎？", tip: "like_an 建議連音，唸成 lai-kan。", traps: { "employer": "Employer 重音在 ploy，不要唸成 Employee。" } },
            { id: "u1-4", type: "Idiom", text: "Role-playing is <span class='highlight-kw'>my cup of tea</span>.", plain: "Role-playing is my cup of tea.", mean: "角色扮演是我拿手的。", tip: "cup of tea 為慣用語，請連貫唸成 cu-puv-tea。", traps: { "role": "Role 嘴型要圓，不要唸成 Row。" } }
          ]
        },
        { id: 2, category: "Unit 1: 工作經驗", unitId: "Unit 1", desc: "B. Experience", colorTheme: "green", icon: Briefcase,
          sentences: [
            { id: "u1-5", type: "Exp", text: "I have three years' <span class='highlight-kw'>progressive experience</span> in the hospitality industry.", plain: "I have three years' progressive experience in the hospitality industry.", mean: "我在觀光產業已累積了三年的經驗。", tip: "progressive experience 後稍微停頓。", traps: { "hospitality": "是 Hospitality 不是 Hospital！" } },
            { id: "u1-6", type: "Detail", text: "Advancing from my initial <span class='highlight-kw'>role as a</span> front desk associate with The Lalu to my current position there <span class='highlight-kw'>as a</span> concierge.", plain: "Advancing from my initial role as a front desk associate with The Lalu to my current position there as a concierge.", mean: "從涵碧樓的櫃檯助理，到現在擔任禮賓接待。", tip: "role_as_a 連音唸成 ro-la-za。", traps: { "concierge": "Concierge 是法文借字，字尾 ge 發 [ʒ]。" } },
            { id: "u1-7", type: "Pref", text: "I like to <span class='highlight-kw'>work in</span> the city center.", plain: "I like to work in the city center.", mean: "我喜歡在市中心工作。", tip: "work_in 連音唸成 wer-kin。", traps: { "work": "Work 是 [ɝ] 捲舌音，不要唸成 Walk。" } }
          ]
        },
        { id: 3, category: "Unit 1: 動機與壓力", unitId: "Unit 1", desc: "C. Motivation & Stress", colorTheme: "amber", icon: Lightbulb,
          sentences: [
            { id: "u1-8", type: "Q", text: "Why should we <span class='highlight-kw'>hire</span> you?", plain: "Why should we hire you?", mean: "我們為什麼要雇用你？", tip: "Why 是疑問詞，句尾語調下降。", traps: { "hire": "Hire 只有一個音節，字尾 r 要捲舌。" } },
            { id: "u1-9", type: "A", text: "You should hire me because my experience is <span class='highlight-kw'>aligned with</span> the requirements in your job listing.", plain: "You should hire me because my experience is aligned with the requirements in your job listing.", mean: "因為我符合您的求才條件。", tip: "aligned_with 的 d 聲音很輕，直接滑向 with。", traps: { "aligned": "gn 不發音，只發 line。" } },
            { id: "u1-10", type: "Fit", text: "Then be <span class='highlight-kw'>specific</span> about what makes you a good <span class='highlight-kw'>fit for</span> this role.", plain: "Then be specific about what makes you a good fit for this role.", mean: "那你就要具體說明你符合這個職務的條件。", tip: "fit_for 的 t 可稍微停住。", traps: { "specific": "Specific 重音在 ci。" } },
            { id: "u1-11", type: "Apply", text: "That's why I want to <span class='highlight-kw'>apply for</span> this position in their company.", plain: "That's why I want to apply for this position in their company.", mean: "這就是為什麼我想申請這家公司的這個職位。", tip: "apply_for 請做連音練習。", traps: { "apply": "Apply 重音在 ply。" } },
            { id: "u1-12", type: "Stress", text: "This position can be <span class='highlight-kw'>demanding</span> and <span class='highlight-kw'>stressful</span>.", plain: "This position can be demanding and stressful.", mean: "這個職位要求高，壓力大。", tip: "加強 demanding 和 stressful 的語氣。", traps: { "stressful": "兩個 s 都要清楚，中間 t 別漏。" } },
            { id: "u1-13", type: "Coping", text: "When I feel stressed, I <span class='highlight-kw'>focus on</span> my breathing.", plain: "When I feel stressed, I focus on my breathing.", mean: "當我感到壓力時，我會專注於呼吸。", tip: "focus_on 連音唸成 fo-kə-san。", traps: { "focus": "o 發雙母音 [oʊ]。" } },
            { id: "u1-14", type: "Habit", text: "I practice guided <span class='highlight-kw'>meditation</span> in the morning before work.", plain: "I practice guided meditation in the morning before work.", mean: "早上上班之前我會做冥想練習。", tip: "meditation 字較長，請放慢速度。", traps: { "meditation": "前段是 Medi (麥迪)，不是 Mei-di。" } },
            { id: "u1-15", type: "Tips", text: "That's too <span class='highlight-kw'>concise</span>. You need to tell them more details.", plain: "That's too concise. You need to tell them more details.", mean: "這太簡潔了。你需要告訴他們更多的細節。", tip: "對比 concise 與 details。", traps: { "concise": "cise 唸起來像 size。" } },
            { id: "u1-16", type: "Research", text: "Did you <span class='highlight-kw'>thoroughly</span> research the company?", plain: "Did you thoroughly research the company?", mean: "你有徹底研究這家公司嗎？", tip: "thoroughly 是魔王字，th 咬舌接 r。", traps: { "thoroughly": "th 咬舌音要出來，不要唸成 s 或 f。" } },
            { id: "u1-17", type: "Mind", text: "I'll <span class='highlight-kw'>keep that in mind</span>.", plain: "I'll keep that in mind.", mean: "我會記住的。", tip: "整句連讀，節奏輕快。", traps: { "mind": "字尾 nd 鼻音要出來。" } }
          ]
        },
        { id: 4, category: "Unit 2: 開場與介紹", unitId: "Unit 2", desc: "A. Opening & Intro", colorTheme: "blue", icon: Layout,
          sentences: [
            { id: "u2-1", type: "Intro", text: "International Trade Show <span class='highlight-kw'>Exhibition</span> Center. This is Linda. How may I <span class='highlight-kw'>help</span> you?", plain: "International Trade Show Exhibition Center. This is Linda. How may I help you?", mean: "國際貿易展覽中心，我是 Linda。請問有什麼需要服務？", tip: "Center 後停頓；may I 連音。", traps: { "exhibition": "h 不發音，唸 ex-i-bition。" } },
            { id: "u2-2", type: "Booking", text: "I am calling to <span class='highlight-kw'>book a</span> booth for the Body, Mind & Soul Exhibition.", plain: "I am calling to book a booth for the Body, Mind & Soul Exhibition.", mean: "我打來是要預定「身心靈展」的攤位。", tip: "book a 連音 (boo-ka)。", traps: { "booth": "th 舌頭要伸出來，不要唸成 s。" } },
            { id: "u2-3", type: "Address", text: "May I ask how I should <span class='highlight-kw'>address</span> you?", plain: "May I ask how I should address you?", mean: "請問我應該如何稱呼您呢？", tip: "address 重音在第二音節 dress。", traps: { "address": "重音不要放在第一音節。" } },
            { id: "u2-5", type: "Offer", text: "Shall I <span class='highlight-kw'>brief you on</span> the kinds of booths we are offering?", plain: "Shall I brief you on the kinds of booths we are offering?", mean: "需要我介紹展位類型嗎？", tip: "brief you on 三字連讀。", traps: { "brief": "字尾 f 咬下唇吐氣。" } },
            { id: "u2-6", type: "Types", text: "We have linear booths, <span class='highlight-kw'>corner</span> booths, <span class='highlight-kw'>peninsula</span> booths, and <span class='highlight-kw'>island</span> booths.", plain: "We have linear booths, corner booths, peninsula booths, and island booths.", mean: "我們有線型、角落、半島型和中島式展位。", tip: "列舉時前三個語調上揚，最後 island booths 下降。", traps: { "island": "s 不發音，唸 Eye-land。" } },
            { id: "u2-8", type: "Diff", text: "They are totally different <span class='highlight-kw'>in terms of</span> size, dimensions, and price.", plain: "They are totally different in terms of size, dimensions, and price.", mean: "它們在尺寸、面積和價格上完全不同。", tip: "in terms of (就...而言) 連讀 (term-zof)。", traps: { "terms": "terms 的 s 接 of 變成 zof。" } }
          ]
        },
        { id: 5, category: "Unit 2: 詢價與規格", unitId: "Unit 2", desc: "C. Cost & Specs", colorTheme: "purple", icon: MapPin,
          sentences: [
            { id: "u2-10", type: "Suggest", text: "Then <span class='highlight-kw'>linear</span> booths may be a good <span class='highlight-kw'>option</span> for you.", plain: "Then linear booths may be a good option for you.", mean: "那您可以考慮線型展位。", tip: "option 的 p 氣音要輕。", traps: { "linear": "重音在 Li，唸 Li-nee-er。" } },
            { id: "u2-12", type: "Price", text: "It will be NT$ 95,000 with a <span class='highlight-kw'>package</span>. This price includes <span class='highlight-kw'>VAT</span>.", plain: "It will be ninety-five thousand NT dollars with a package. This price includes VAT.", mean: "套裝方案是九萬五千元(含稅)。", tip: "95,000 唸 ninety-five thousand；VAT 唸 V-A-T。", traps: { "package": "字尾 age 唸 [ɪdʒ]。" } },
            { id: "u2-13", type: "Include", text: "What does the package <span class='highlight-kw'>include</span>?", plain: "What does the package include?", mean: "套裝方案包含什麼？", tip: "What_does_the 常快速連讀。", traps: { "include": "cl 結合緊密。" } },
            { id: "u2-14", type: "Detail", text: "The package <span class='highlight-kw'>comprises</span> lighting, a signboard, carpet, partition walls, five chairs, and one round table.", plain: "The package comprises lighting, a signboard, carpet, partition walls, five chairs, and one round table.", mean: "包含照明、招牌、地毯、隔牆、五椅一桌。", tip: "長句請分段。comprises 重音在後。", traps: { "comprises": "prise 發 [praɪz]。" } },
            { id: "u2-16", type: "Arrange", text: "We'll arrange <span class='highlight-kw'>linear</span> booths in a <span class='highlight-kw'>straight</span> line.", plain: "We'll arrange linear booths in a straight line.", mean: "我們會將線型展位排成一條直線。", tip: "straight line 中間的 t 和 l 會黏在一起。", traps: { "straight": "gh 不發音。" } },
            { id: "u2-17", type: "Surround", text: "Does that mean they will be <span class='highlight-kw'>surrounded by</span> other exhibitors' booths?", plain: "Does that mean they will be surrounded by other exhibitors' booths?", mean: "這意味著它們將被其他參展商包圍嗎？", tip: "surrounded by (被包圍)；exhibitors 重音在第二音節。", traps: { "surrounded": "重音在 roun。" } }
          ]
        },
        { id: 6, category: "Unit 2: 完成預定", unitId: "Unit 2", desc: "E. Booking", colorTheme: "teal", icon: Zap,
          sentences: [
            { id: "u2-19", type: "Next", text: "How do I <span class='highlight-kw'>proceed</span> with the booking?", plain: "How do I proceed with the booking?", mean: "我該如何繼續預定的手續呢？", tip: "do I 連音 (du-wai)；proceed 注意長音 [i]。", traps: { "proceed": "重音在後 ceed。" } },
            { id: "u2-20", type: "Email", text: "Would you like me to <span class='highlight-kw'>e-mail</span> the online <span class='highlight-kw'>application</span> link to you?", plain: "Would you like me to e-mail the online application link to you?", mean: "需要我把線上申請連結寄給您嗎？", tip: "Would you 連音；application 重音在 ca。", traps: { "application": "app 發蝴蝶音 [æ]。" } },
            { id: "u2-22", type: "Closing", text: "Thank you for <span class='highlight-kw'>calling</span>. Hope to <span class='highlight-kw'>hear</span> from you soon.", plain: "Thank you for calling. Hope to hear from you soon.", mean: "謝謝來電，希望能很快收到您的回覆。", tip: "hear from you 語氣要親切上揚。", traps: { "hear": "不要唸成 here 的短音，要飽滿。" } }
          ]
        },
        { id: 7, category: "Unit 3: 會議開場", unitId: "Unit 3", desc: "A. Opening", colorTheme: "indigo", icon: MessageCircle,
          sentences: [
            { id: "u3-1", type: "Opening", text: "We are here to <span class='highlight-kw'>discuss</span> our exhibition booth for the <span class='highlight-kw'>trade show</span>.", plain: "We are here to discuss our exhibition booth for the trade show.", mean: "我們今天是來討論商展的展位事宜。", tip: "discuss 接 our 連讀。", traps: { "discuss": "重音在 scuss。" } },
            { id: "u3-2", type: "Phrase", text: "Now let's <span class='highlight-kw'>get the ball rolling</span>.", plain: "Now let's get the ball rolling.", mean: "現在讓我們開始討論吧！", tip: "慣用語：開始進行。", traps: { "rolling": "roll 舌頭要捲。" } },
            { id: "u3-3", type: "Ask", text: "Sally, what do you <span class='highlight-kw'>have in mind</span>?", plain: "Sally, what do you have in mind?", mean: "Sally，你有什麼想法嗎？", tip: "have in 連音 (ha-vin)。", traps: { "mind": "nd 鼻音結尾。" } }
          ]
        },
        { id: 8, category: "Unit 3: 提出與討論", unitId: "Unit 3", desc: "B. Discussion", colorTheme: "orange", icon: Lightbulb,
          sentences: [
            { id: "u3-4", type: "Idea", text: "I think we would <span class='highlight-kw'>go for</span> the <span class='highlight-kw'>peninsula</span> booth.", plain: "I think we would go for the peninsula booth.", mean: "我想我們會選擇半島式展位。", tip: "go for (選擇)；peninsula 音節多請放慢。", traps: { "peninsula": "重音在 nin。" } },
            { id: "u3-5", type: "Clarify", text: "Sorry, I didn't <span class='highlight-kw'>catch</span> the last few words of what you just <span class='highlight-kw'>said</span>.", plain: "Sorry, I didn't catch the last few words of what you just said.", mean: "抱歉，我沒聽清楚你剛才說的最後幾個字。", tip: "catch 的 t 不發音。", traps: { "catch": "蝴蝶音 [æ]。" } },
            { id: "u3-6", type: "Repeat", text: "Could you please <span class='highlight-kw'>run that by me</span> again?", plain: "Could you please run that by me again?", mean: "可以請你再說一遍嗎？", tip: "me again 連音。", traps: { "run": "r 要圓唇。" } },
            { id: "u3-8", type: "Q", text: "Do we need to <span class='highlight-kw'>make a decision</span> today?", plain: "Do we need to make a decision today?", mean: "我們今天需要做決定嗎？", tip: "make a 連音。", traps: { "decision": "si 發 [ʒ] (日) 的音。" } }
          ]
        },
        { id: 9, category: "Unit 3: 反對與支持", unitId: "Unit 3", desc: "C. Pros & Cons", colorTheme: "teal", icon: Check,
          sentences: [
            { id: "u3-9", type: "Q", text: "Why are you all so <span class='highlight-kw'>keen on</span> a peninsula booth?", plain: "Why are you all so keen on a peninsula booth?", mean: "為什麼你們都對半島展位情有獨鍾？", tip: "keen on 連音 (kee-non)。", traps: { "keen": "長音 [i] 要微笑。" } },
            { id: "u3-10", type: "Reason", text: "Because all of our products are very <span class='highlight-kw'>bulky</span> and they will <span class='highlight-kw'>take up</span> a lot of space.", plain: "Because all of our products are very bulky and they will take up a lot of space.", mean: "因為我們所有產品都很笨重，且很佔空間。", tip: "take up (佔據) 連音。", traps: { "bulky": "l 要含在喉嚨。" } },
            { id: "u3-11", type: "Contrast", text: "The linear booth is too <span class='highlight-kw'>cramped</span> to display all of our featured products.", plain: "The linear booth is too cramped to display all of our featured products.", mean: "線型展位太擠，無法展示我們所有的特色產品。", tip: "cramped (擠) 與 spacious (寬) 相反。", traps: { "cramped": "mp 閉嘴後接 t。" } },
            { id: "u3-12", type: "Second", text: "I agree with Sally. I <span class='highlight-kw'>second</span> that.", plain: "I agree with Sally. I second that.", mean: "我同意 Sally，我附議。", tip: "second 當動詞是附議。", traps: { "second": "重音在 se。" } }
          ]
        },
        { id: 10, category: "Unit 3: 優勢與結論", unitId: "Unit 3", desc: "D. Benefits & End", colorTheme: "amber", icon: Save,
          sentences: [
            { id: "u3-14", type: "Benefit", text: "A peninsula booth can allow our <span class='highlight-kw'>potential</span> buyers to move around <span class='highlight-kw'>comfortably</span>.", plain: "A peninsula booth can allow our potential buyers to move around comfortably.", mean: "半島式展位讓潛在買家能舒適地四處走動。", tip: "comfortably 唸快 (comf-ta-bly)。", traps: { "comfortably": "重音在第一音節 Com。" } },
            { id: "u3-15", type: "Benefit", text: "A <span class='highlight-kw'>spacious</span> booth will encourage the potential buyers to <span class='highlight-kw'>linger</span> inside longer.", plain: "A spacious booth will encourage the potential buyers to linger inside longer.", mean: "寬敞的展位有助於潛在買家逗留久一點。", tip: "linger (逗留) 是好字。", traps: { "spacious": "ci 發 [ʃ] (許)。" } },
            { id: "u3-17", type: "Winner", text: "The peninsula booth <span class='highlight-kw'>sounds like a winner</span> to me.", plain: "The peninsula booth sounds like a winner to me.", mean: "半島式展位聽起來很棒 (是首選)。", tip: "sounds like a winner 是慣用語。", traps: { "winner": "短音 [ɪ]，嘴放鬆。" } },
            { id: "u3-20", type: "End", text: "If nobody has anything else to add, then let's <span class='highlight-kw'>call it a day</span>.", plain: "If nobody has anything else to add, then let's call it a day.", mean: "如果沒有其它動議，那就散會吧！", tip: "call it a day (散會) 連讀。", traps: { "call": "all 音要圓。" } }
          ]
        },
        { id: 11, category: "Unit 4: 報到確認", unitId: "Unit 4", desc: "A. Checking In", colorTheme: "blue", icon: MapPin,
          sentences: [
            { id: "u4-1", type: "Ask", text: "So, is this the room where the meeting will be <span class='highlight-kw'>held</span>?", plain: "So, is this the room where the meeting will be held?", mean: "這就是待會要舉行會議的房間嗎？", tip: "will be held 中間 h 氣音很弱。", traps: { "held": "尾音 ld 要輕。" } },
            { id: "u4-2", type: "Intro", text: "Yes, <span class='highlight-kw'>ma'am</span>. I am the floor manager.", plain: "Yes, ma'am. I am the floor manager.", mean: "是的，女士。我是現場經理。", tip: "ma'am 語調微微上揚。", traps: { "ma'am": "母音 [æ] 要扁平。" } },
            { id: "u4-3", type: "Sure", text: "I am here to <span class='highlight-kw'>make sure</span> that you have everything you need.", plain: "I am here to make sure that you have everything you need.", mean: "我在這裡是為了確保您擁有會議所需的一切。", tip: "make sure 的 k 和 s 連接。", traps: { "everything": "重音在第一音節。" } }
          ]
        },
        { id: 12, category: "Unit 4: 設備與場地", unitId: "Unit 4", desc: "B. Equipment", colorTheme: "purple", icon: Layout,
          sentences: [
            { id: "u4-4", type: "Setup", text: "I like the <span class='highlight-kw'>U-shaped</span> table arrangement.", plain: "I like the U-shaped table arrangement.", mean: "我喜歡這個馬蹄型會議桌的安排。", tip: "arrangement 重音在 range。", traps: { "U-shaped": "ed 發 [t] 音。" } },
            { id: "u4-6", type: "Equip", text: "Our <span class='highlight-kw'>venue</span> provides all of the latest <span class='highlight-kw'>AV</span> technology.", plain: "Our venue provides all of the latest AV technology.", mean: "我們的場地提供所有最新的影音科技設備。", tip: "AV 兩個字母分開重讀。", traps: { "venue": "字尾 [u] 要噘嘴。" } },
            { id: "u4-8", type: "Kind", text: "That's very <span class='highlight-kw'>kind of</span> you.", plain: "That's very kind of you.", mean: "你人真好。", tip: "kind of 唸 kin-dov。", traps: { "kind": "d 接 of 變成連音。" } }
          ]
        },
        { id: 13, category: "Unit 4: 網路連線", unitId: "Unit 4", desc: "C. Internet", colorTheme: "green", icon: Wifi,
          sentences: [
            { id: "u4-9", type: "Wifi", text: "How can I <span class='highlight-kw'>access</span> the Internet here?", plain: "How can I access the Internet here?", mean: "這裡要如何上網呢？", tip: "access 的 cc 要清晰。", traps: { "access": "兩個 s 都要發音清晰。" } },
            { id: "u4-10", type: "Wireless", text: "Once you <span class='highlight-kw'>turn on</span> your laptop, a wireless Internet connection is available.", plain: "Once you turn on your laptop, a wireless Internet connection is available.", mean: "一旦您開啟筆電，就可以使用無線網路。", tip: "turn on 連音。", traps: { "available": "重音在 vai。" } },
            { id: "u4-11", type: "Pass", text: "What is the <span class='highlight-kw'>password</span> for the WiFi?", plain: "What is the password for the WiFi?", mean: "WiFi 的密碼是什麼？", tip: "WiFi 唸 [waɪ-faɪ]。", traps: { "password": "pass 扁嘴，word 捲舌。" } },
            { id: "u4-13", type: "Scan", text: "You can use the <span class='highlight-kw'>built-in</span> camera to <span class='highlight-kw'>scan</span> the QR Code.", plain: "You can use the built-in camera to scan the QR Code.", mean: "您可以使用內建相機掃描 QR Code。", tip: "built-in 的 t 連到 in。", traps: { "scan": "sk 的 k 不送氣。" } },
            { id: "u4-14", type: "Eco", text: "That's handy and <span class='highlight-kw'>eco-friendly</span>.", plain: "That's handy and eco-friendly.", mean: "那真的很方便又環保。", tip: "eco 發 E-co。", traps: { "eco-friendly": "friendly 的 d 不發音。" } }
          ]
        },
        { id: 14, category: "Unit 4: 故障排除", unitId: "Unit 4", desc: "D. Troubleshooting", colorTheme: "amber", icon: Settings,
          sentences: [
            { id: "u4-15", type: "Error", text: "Wait. <span class='highlight-kw'>How come</span> there's no sound coming out?", plain: "Wait. How come there's no sound coming out?", mean: "等等。怎麼會沒有聲音出來呢？", tip: "How come (怎麼會) 常見口語。", traps: { "sound": "d 在 coming 前不明顯。" } },
            { id: "u4-19", type: "Connect", text: "This wire here should be <span class='highlight-kw'>connected to</span> this port.", plain: "This wire here should be connected to this port.", mean: "這條線應該要接到這個插孔。", tip: "connected to 兩個 t 合併。", traps: { "port": "嘴型要圓。" } },
            { id: "u4-20", type: "Solve", text: "Good thing that I <span class='highlight-kw'>rehearsed</span> to <span class='highlight-kw'>pinpoint</span> the audio problem.", plain: "Good thing that I rehearsed to pinpoint the audio problem.", mean: "還好我有排練，才能精確查出聲音問題。", tip: "rehearsed 的 ed 發 [t]。", traps: { "pinpoint": "兩個 p 都要噴氣。" } },
            { id: "u4-21", type: "Idiom", text: "A <span class='highlight-kw'>stitch</span> in time saves nine.", plain: "A stitch in time saves nine.", mean: "及時補救，事半功倍。", tip: "Stitch 的 ch 和 in 連音。", traps: { "saves": "s 發 [z] 音。" } }
          ]
        },
        { id: 15, category: "Unit 4: 最後確認", unitId: "Unit 4", desc: "E. Final Check", colorTheme: "teal", icon: Check,
          sentences: [
            { id: "u4-22", type: "Check", text: "Could you <span class='highlight-kw'>go over</span> all the <span class='highlight-kw'>facilities</span> to ensure that everything works?", plain: "Could you go over all the facilities to ensure that everything works?", mean: "能否再檢查一次所有設施，確保運作正常？", tip: "go over (檢查) 中間 w 滑音。", traps: { "facilities": "重音在 ci [sɪ]。" } },
            { id: "u4-24", type: "Detail", text: "You do have an <span class='highlight-kw'>eye for detail</span>.", plain: "You do have an eye for detail.", mean: "您真的很注重細節。", tip: "have an eye 連成一氣。", traps: { "eye": "eye 和 for 連音。" } },
            { id: "u4-25", type: "Flatter", text: "Thank you for the compliment. I am <span class='highlight-kw'>flattered</span>.", plain: "Thank you for the compliment. I am flattered.", mean: "謝謝您的讚美。我受寵若驚。", tip: "flattered 的 tt 輕快帶過。", traps: { "flattered": "ed 發 [d]。" } },
            { id: "u4-26", type: "Superb", text: "<span class='highlight-kw'>Superb</span>! I am now <span class='highlight-kw'>looking forward to</span> the meeting.", plain: "Superb! I am now looking forward to the meeting.", mean: "太棒了！我很期待接下來的會議。", tip: "looking forward to 是必背片語。", traps: { "superb": "重音在後 [pɝb]。" } }
          ]
        },
        { id: 16, category: "Unit 5: 差旅政策確認", unitId: "Unit 5", desc: "A. Policy Check", colorTheme: "red", icon: CreditCard,
          sentences: [
            { id: "u5-1", type: "Check", text: "Hi, Janet, are you <span class='highlight-kw'>done with</span> the invitation letters to the keynote speakers?", plain: "Hi, Janet, are you done with the invitation letters to the keynote speakers?", mean: "嗨 Janet，給主講人的邀請函妳完成了嗎？", tip: "Done with 的 n 和 w 可以連得快一點。", traps: { "done": "n 的鼻音要確實。" } },
            { id: "u5-2", type: "Reply", text: "Yes, almost. I'm not sure whether I've included sufficient information about our <span class='highlight-kw'>reimbursement policy</span>.", plain: "Yes, almost. I'm not sure whether I've included sufficient information about our reimbursement policy.", mean: "是的，快好了。我不確定我是否提供了關於我們核銷政策的充足資訊。", tip: "whether I've 可以連音唸成 [wɛðɚ-raɪv]。", traps: { "sufficient": "ci 發 [ʃ] 的音。" } }
          ]
        },
        { id: 17, category: "Unit 5: 費用說明", unitId: "Unit 5", desc: "B. Explaining Rules", colorTheme: "amber", icon: Briefcase,
          sentences: [
            { id: "u5-3", type: "Rule", text: "It's very important to inform our keynote speakers that they will be <span class='highlight-kw'>reimbursed for</span> the <span class='highlight-kw'>actual costs</span> of travel and <span class='highlight-kw'>subsistence expenditures</span>.", plain: "It's very important to inform our keynote speakers that they will be reimbursed for the actual costs of travel and subsistence expenditures.", mean: "告知我們的主講人他們將獲得差旅費和日常開支的實報實銷，這非常重要。", tip: "Reimbursed for 的 [d] 和 [f] 不好接，[d] 可以輕輕帶過。", traps: { "actual": "tu 發 [tʃ] (去) 的音。" } },
            { id: "u5-4", type: "Shock", text: "Actual costs of travel? Seriously? You mean they can fly <span class='highlight-kw'>business class</span>?", plain: "Actual costs of travel? Seriously? You mean they can fly business class?", mean: "差旅費實報實銷？真的嗎？妳是說他們可以搭商務艙？", tip: "Seriously 語調上揚表示驚訝。", traps: { "seriously": "ri 發音要捲舌。" } },
            { id: "u5-5", type: "Correct", text: "Oops. Nice one. We only <span class='highlight-kw'>pay for</span> the <span class='highlight-kw'>economy class</span>.", plain: "Oops. Nice one. We only pay for the economy class.", mean: "噢，想得美。我們只支付經濟艙的費用。", tip: "Nice one 是諷刺語氣，要唸得俏皮一點。", traps: { "economy": "重音在 co。" } },
            { id: "u5-6", type: "Remind", text: "Please <span class='highlight-kw'>make sure</span> that our keynote speakers are <span class='highlight-kw'>aware of</span> this before they book their flight.", plain: "Please make sure that our keynote speakers are aware of this before they book their flight.", mean: "請確保我們的主講人在訂機票前知道這一點。", tip: "Aware of 必連音 [əˋwɛr-əv]。", traps: { "aware": "r 接 of 連音。" } }
          ]
        },
        { id: 18, category: "Unit 5: 配偶與住宿", unitId: "Unit 5", desc: "C. Spouse & Stay", colorTheme: "green", icon: MapPin,
          sentences: [
            { id: "u5-7", type: "News", text: "I see. Oh, <span class='highlight-kw'>by the way</span>, Dr. Lin, one of the keynote speakers from Sweden mentioned that his wife will travel with him.", plain: "I see. Oh, by the way, Dr. Lin, one of the keynote speakers from Sweden mentioned that his wife will travel with him.", mean: "我明白了。噢對了，來自瑞典的主講人之一林博士提到他太太會隨行。", tip: "One of 連音 [wʌn-əv]。", traps: { "sweden": "[sw] 的嘴型變化要注意。" } },
            { id: "u5-8", type: "Q", text: "She's <span class='highlight-kw'>never been to</span> Asia before. <span class='highlight-kw'>What about</span> her flight ticket cost?", plain: "She's never been to Asia before. What about her flight ticket cost?", mean: "她以前從沒去過亞洲。那她的機票費用呢？", tip: "What about 是超級常用的連音 [hwɑ-tə-baʊt]。", traps: { "asia": "s 發 [ʒ] 或 [ʃ] 皆可，重音在 A。" } },
            { id: "u5-9", type: "Policy", text: "We won't be able to reimburse any expenses <span class='highlight-kw'>incurred by</span> spouses or other family members who <span class='highlight-kw'>accompany</span> our keynote speakers <span class='highlight-kw'>on their travels</span>.", plain: "We won't be able to reimburse any expenses incurred by spouses or other family members who accompany our keynote speakers on their travels.", mean: "我們無法核銷任何由配偶或其他隨行家人產生的費用。", tip: "建議斷句：expenses | incurred by spouses | or other family members。", traps: { "incurred": "cur 捲舌音。" } },
            { id: "u5-10", type: "Sol", text: "All right. I will tell Dr. Lin that he needs to <span class='highlight-kw'>take care of</span> his wife's travel expenses <span class='highlight-kw'>on his own</span>.", plain: "All right. I will tell Dr. Lin that he needs to take care of his wife's travel expenses on his own.", mean: "好的。我會告訴林博士他需要自行負擔他太太的旅費。", tip: "Take care of 連音 [tek-kɛr-əv]。", traps: { "own": "on his own 連音。" } },
            { id: "u5-11", type: "Hotel", text: "However, Dr. Lin doesn't need to pay any <span class='highlight-kw'>extra cost</span> for the <span class='highlight-kw'>accommodation</span>.", plain: "However, Dr. Lin doesn't need to pay any extra cost for the accommodation.", mean: "不過，林博士不需要為住宿支付任何額外費用。", tip: "Accommodation 慢慢唸準確。", traps: { "extra": "x 發 [ks]。" } }
          ]
        },
        { id: 19, category: "Unit 5: 高鐵與津貼", unitId: "Unit 5", desc: "D. HSR & Allowances", colorTheme: "teal", icon: CreditCard,
          sentences: [
            { id: "u5-13", type: "Ask", text: "<span class='highlight-kw'>What about</span> the <span class='highlight-kw'>high-speed rail</span> ticket cost? Also the economy class?", plain: "What about the high-speed rail ticket cost? Also the economy class?", mean: "那高鐵車票的費用呢？也是經濟艙嗎？", tip: "Rail 結尾的 [l] 聲音要拉長一點點。", traps: { "rail": "不要唸成 ray-o。" } },
            { id: "u5-14", type: "Reply", text: "Oh, <span class='highlight-kw'>when it comes to</span> HSR, it's a <span class='highlight-kw'>different story</span>.", plain: "Oh, when it comes to HSR, it's a different story.", mean: "噢，說到高鐵，那又是另一回事了。", tip: "When it comes to 連音唸 [wɛn-ɪt-kʌmz-tu]。", traps: { "hsr": "字母分開唸清楚。" } },
            { id: "u5-15", type: "Info", text: "Please <span class='highlight-kw'>inform them</span> that the <span class='highlight-kw'>daily allowance</span> is <span class='highlight-kw'>no more than</span> NT$ 1500.", plain: "Please inform them that the daily allowance is no more than fifteen hundred NT dollars.", mean: "請告知他們每日生活津貼不超過台幣 1500 元。", tip: "1500 唸 fifteen hundred 比較順口。", traps: { "allowance": "low 發 [laʊ] (老) 的音。" } },
            { id: "u5-16", type: "Receipt", text: "O.K. <span class='highlight-kw'>Last but not least</span>. Do they need to <span class='highlight-kw'>submit</span> the <span class='highlight-kw'>original receipts</span> for reimbursement?", plain: "O.K. Last but not least. Do they need to submit the original receipts for reimbursement?", mean: "好的。最後一點。他們需要繳交原始收據來核銷嗎？", tip: "Last but not least (最後但同樣重要)。", traps: { "receipts": "p 不發音！" } }
          ]
        },
        { id: 20, category: "Unit 6: 緊急打擾", unitId: "Unit 6", desc: "A. Interruption", colorTheme: "red", icon: AlertTriangle,
          sentences: [
            { id: "u6-1", type: "Ask", text: "Hi, John, <span class='highlight-kw'>do you have a minute</span>?", plain: "Hi, John, do you have a minute?", mean: "嗨 John，你有空嗎？", tip: "Have a 必連音 [hæ-və]。", traps: { "minute": "t 可以稍微閉氣不爆破。" } },
            { id: "u6-2", type: "Busy", text: "Well, actually, I am <span class='highlight-kw'>in the middle of something</span> now. Can I <span class='highlight-kw'>get back to</span> you later?", plain: "Well, actually, I am in the middle of something now. Can I get back to you later?", mean: "這個嘛，事實上我現在正忙著。我可以稍後再回覆你嗎？", tip: "Get back to 的 [k] 接 [t]，[k] 會變成無聲停頓。", traps: { "middle": "ddle 發 [d!]。" } },
            { id: "u6-3", type: "Urgent", text: "But it's <span class='highlight-kw'>urgent</span>. I need to <span class='highlight-kw'>talk to</span> you right now.", plain: "But it's urgent. I need to talk to you right now.", mean: "但這很緊急。我現在就需要和你談談。", tip: "Urgent 的 [t] 結尾要輕脆。", traps: { "urgent": "Ur 要捲舌。" } }
          ]
        },
        { id: 21, category: "Unit 6: 壞消息", unitId: "Unit 6", desc: "B. Breaking News", colorTheme: "orange", icon: AlertTriangle,
          sentences: [
            { id: "u6-4", type: "Direct", text: "Come on, Janet! You know how busy I am. Could we <span class='highlight-kw'>get down to business</span>?", plain: "Come on, Janet! You know how busy I am. Could we get down to business?", mean: "拜託，Janet！妳知道我有多忙。我們可以直接說重點嗎？", tip: "Business 只有兩個音節 [bɪz-nɪs]。", traps: { "business": "不要唸成 busy-ness。" } },
            { id: "u6-5", type: "News", text: "There was a <span class='highlight-kw'>terrorist</span> attack on <span class='highlight-kw'>Stockholm</span> yesterday.", plain: "There was a terrorist attack on Stockholm yesterday.", mean: "昨天斯德哥爾摩發生了恐怖攻擊。", tip: "Stockholm 注意 [st] 不送氣。", traps: { "terrorist": "重音在第一音節。" } },
            { id: "u6-6", type: "Shock", text: "<span class='highlight-kw'>Stockholm</span>? Isn't it in Northern Europe? What does it have to do with us?", plain: "Stockholm? Isn't it in Northern Europe? What does it have to do with us?", mean: "斯德哥爾摩？那不是在北歐嗎？這跟我們有什麼關係？", tip: "What does it 唸快時，t 會變成輕彈音。", traps: { "stockholm": "lm 的 l 很輕。" } }
          ]
        },
        { id: 22, category: "Unit 6: 關聯與傷亡", unitId: "Unit 6", desc: "C. Casualty", colorTheme: "purple", icon: MapPin,
          sentences: [
            { id: "u6-7", type: "Link", text: "Remember one of our keynote speakers, Dr. Lin, is flying to Taiwan from Sweden?", plain: "Remember one of our keynote speakers, Dr. Lin, is flying to Taiwan from Sweden?", mean: "記得我們的主講人之一林博士，正要從瑞典飛來台灣嗎？", tip: "One of 連音 [wʌn-əv]。", traps: { "sweden": "Swe 發 [swi]。" } },
            { id: "u6-8", type: "Sad", text: "I am afraid not. He and his wife were doing some shopping for this business trip to Asia when the <span class='highlight-kw'>hijacked</span> truck drove into the department store.", plain: "I am afraid not. He and his wife were doing some shopping for this business trip to Asia when the hijacked truck drove into the department store.", mean: "恐怕不太好。當那輛被劫持的卡車衝進百貨公司時，他和太太正為了這趟亞洲出差在購物。", tip: "Hijacked truck 的 [t] (ed結尾) 接 [t] (truck)，只發一次強音 [t]。", traps: { "hijacked": "ed 發 [t]。" } },
            { id: "u6-9", type: "Dead", text: "Five people were killed including one <span class='highlight-kw'>British</span> man and a <span class='highlight-kw'>Belgian</span> woman.", plain: "Five people were killed including one British man and a Belgian woman.", mean: "五人遇害，其中包括一名英國男子和一名比利時婦女。", tip: "British man 注意 [ʃ] 接 [m] 的嘴型轉換。", traps: { "belgian": "g 發 [dʒ]。" } }
          ]
        },
        { id: 23, category: "Unit 6: 危機處理", unitId: "Unit 6", desc: "D. Crisis Mgmt", colorTheme: "teal", icon: Settings,
          sentences: [
            { id: "u6-10", type: "React", text: "Oh, my goodness. They must have been <span class='highlight-kw'>terrified</span>. How are they now?", plain: "Oh, my goodness. They must have been terrified. How are they now?", mean: "噢，我的天啊。他們一定嚇壞了。他們現在還好嗎？", tip: "Must have 口語常縮讀為 [mʌst-əv]。", traps: { "terrified": "重音在 Ter。" } },
            { id: "u6-11", type: "Status", text: "I guess they are still <span class='highlight-kw'>struggling</span> to <span class='highlight-kw'>cope with</span> this <span class='highlight-kw'>traumatic</span> event.", plain: "I guess they are still struggling to cope with this traumatic event.", mean: "我想他們仍在努力平復這一創傷事件。", tip: "Struggling 的 [str] 不送氣。", traps: { "traumatic": "trau 發 [traʊ]。" } },
            { id: "u6-12", type: "Action", text: "Can you find someone to <span class='highlight-kw'>replace</span> him at such <span class='highlight-kw'>short notice</span>?", plain: "Can you find someone to replace him at such short notice?", mean: "妳能在這麼短的時間內找人接替他嗎？", tip: "Short notice 的 [t] 接 [n] 變成鼻腔爆破。", traps: { "replace": "p 要噴氣。" } },
            { id: "u6-13", type: "Idea", text: "Well...let me see. A couple of names have just <span class='highlight-kw'>crossed my mind</span>.", plain: "Well...let me see. A couple of names have just crossed my mind.", mean: "嗯...讓我想想。我剛想到幾個人名。", tip: "Crossed my 的 ed [t] 接 [m] 變得很輕。", traps: { "mind": "nd 鼻音。" } },
            { id: "u6-14", type: "Thanks", text: "I totally understand your <span class='highlight-kw'>frustration</span> and concern. Thank you so much. I <span class='highlight-kw'>owe</span> you one.", plain: "I totally understand your frustration and concern. Thank you so much. I owe you one.", mean: "我完全理解妳的挫折與擔憂。非常感謝，我欠你一個人情。", tip: "Owe you 連音 [o-ju]。", traps: { "frustration": "[str] 不送氣。" } }
          ]
        }
      ];

      const initialPrepositionData = [
        { id: "p1", phrase: "help ... with", sentence: "Can you <span class='highlight-kw'>help</span> me <span class='highlight-kw'>with</span> my job interview?", plain: "Can you help me with my job interview?", mean: "協助某人處理某事", tip: "help 結尾 p 閉唇接 with。" },
        { id: "p2", phrase: "aligned with", sentence: "My experience is <span class='highlight-kw'>aligned with</span> the requirements.", plain: "My experience is aligned with the requirements.", mean: "與...一致", tip: "aligned d 輕讀接 with。" },
        { id: "p3", phrase: "focus on", sentence: "I <span class='highlight-kw'>focus on</span> my breathing.", plain: "I focus on my breathing.", mean: "專注於", tip: "focus on 連音 fo-kə-san。" },
        { id: "p4", phrase: "apply for", sentence: "I want to <span class='highlight-kw'>apply for</span> this position.", plain: "I want to apply for this position.", mean: "申請", tip: "apply y 接 for 連貫。" },
        { id: "p5", phrase: "brief ... on", sentence: "Shall I <span class='highlight-kw'>brief</span> you <span class='highlight-kw'>on</span> the booths?", plain: "Shall I brief you on the booths?", mean: "向...做簡報", tip: "brief f 咬唇接 on。" },
        { id: "p6", phrase: "in terms of", sentence: "Different <span class='highlight-kw'>in terms of</span> size.", plain: "Different in terms of size.", mean: "就...而言", tip: "terms s 接 of 變 zof。" },
        { id: "p7", phrase: "surrounded by", sentence: "<span class='highlight-kw'>Surrounded by</span> other booths.", plain: "Surrounded by other booths.", mean: "被...包圍", tip: "surrounded d 接 by。" },
        { id: "p8", phrase: "keen on", sentence: "Why so <span class='highlight-kw'>keen on</span> a peninsula booth?", plain: "Why so keen on a peninsula booth?", mean: "熱衷於", tip: "keen n 接 on 連音。" },
        { id: "p9", phrase: "go for", sentence: "We would <span class='highlight-kw'>go for</span> the peninsula booth.", plain: "We would go for the peninsula booth.", mean: "選擇", tip: "go 圓唇接 for。" },
        { id: "p10", phrase: "connected to", sentence: "Be <span class='highlight-kw'>connected to</span> this port.", plain: "Be connected to this port.", mean: "連接到", tip: "connected ed 接 to 合併。" },
        { id: "p11", phrase: "looking forward to", sentence: "I am <span class='highlight-kw'>looking forward to</span> the meeting.", plain: "I am looking forward to the meeting.", mean: "期待", tip: "to 弱化成 tə。" },
        { id: "p12", phrase: "done with", sentence: "Are you <span class='highlight-kw'>done with</span> the invitation letters?", plain: "Are you done with the invitation letters?", mean: "完成...", tip: "done n 接 with。" },
        { id: "p13", phrase: "reimbursed for", sentence: "They will be <span class='highlight-kw'>reimbursed for</span> the actual costs.", plain: "They will be reimbursed for the actual costs.", mean: "核銷...的費用", tip: "reimbursed d 接 for。" },
        { id: "p14", phrase: "pay for", sentence: "We only <span class='highlight-kw'>pay for</span> the economy class.", plain: "We only pay for the economy class.", mean: "支付...費用", tip: "pay y 接 for。" },
        { id: "p15", phrase: "aware of", sentence: "Make sure they are <span class='highlight-kw'>aware of</span> this.", plain: "Make sure they are aware of this.", mean: "意識到/知道", tip: "aware r 接 of 連音。" },
        { id: "p16", phrase: "incurred by", sentence: "Expenses <span class='highlight-kw'>incurred by</span> spouses.", plain: "Expenses incurred by spouses.", mean: "由...產生(費用)", tip: "incurred d 接 by。" },
        { id: "p17", phrase: "take care of", sentence: "He needs to <span class='highlight-kw'>take care of</span> the expenses.", plain: "He needs to take care of the expenses.", mean: "處理/照顧", tip: "care r 接 of。" },
        { id: "p18", phrase: "when it comes to", sentence: "<span class='highlight-kw'>When it comes to</span> HSR, it's different.", plain: "When it comes to HSR, it's different.", mean: "說到...", tip: "comes z 接 to。" },
        { id: "p19", phrase: "middle of", sentence: "I am in the <span class='highlight-kw'>middle of</span> something.", plain: "I am in the middle of something.", mean: "正忙於...", tip: "middle l 接 of。" },
        { id: "p20", phrase: "get back to", sentence: "Can I <span class='highlight-kw'>get back to</span> you later?", plain: "Can I get back to you later?", mean: "稍後回覆", tip: "back k 接 to 停頓。" },
        { id: "p21", phrase: "talk to", sentence: "I need to <span class='highlight-kw'>talk to</span> you right now.", plain: "I need to talk to you right now.", mean: "和...談話", tip: "talk k 接 to。" },
        { id: "p22", phrase: "cope with", sentence: "Struggling to <span class='highlight-kw'>cope with</span> this event.", plain: "Struggling to cope with this event.", mean: "處理/應對", tip: "cope p 閉唇接 with。" }
      ];

      const InterviewPracticeApp = () => {
        const [hasStarted, setHasStarted] = useState(false);
        const [activeTab, setActiveTab] = useState('vocab');
        const [selectedUnit, setSelectedUnit] = useState('All');
        const [isBlindMode, setIsBlindMode] = useState(false);
        const [showChunks, setShowChunks] = useState(false);
        const [recState, setRecState] = useState({ activeId: null, status: 'idle', feedbackMap: {} });
        const [showDetailsMap, setShowDetailsMap] = useState({});

        const handleStartApp = async () => {
            const recognition = getSharedRecognition();
            if (recognition) {
                try {
                    recognition.start();
                    setTimeout(() => { recognition.stop(); setHasStarted(true); }, 100);
                } catch (err) { console.log("Auto start check", err); setHasStarted(true); }
            } else { alert("您的瀏覽器不支援語音識別"); setHasStarted(true); }
        };

        const stopGlobalRecording = () => {
          if (globalRecognition) { try { globalRecognition.stop(); } catch(e) {} }
          if (globalTimeout) { clearTimeout(globalTimeout); globalTimeout = null; }
        };

        const handleStartRecording = (id, targetText, diagnosticsConfig = {}) => {
          stopGlobalRecording();
          if (recState.activeId === id && (recState.status === 'listening' || recState.status === 'init')) {
            setRecState(prev => ({ ...prev, status: 'idle', activeId: null }));
            return;
          }
          const recognition = getSharedRecognition();
          if (!recognition) { alert("瀏覽器不支援語音辨識"); return; }
          setRecState(prev => ({ ...prev, activeId: id, status: 'init', feedbackMap: { ...prev.feedbackMap, [id]: null } }));
          setShowDetailsMap(prev => ({ ...prev, [id]: false }));
          recognition.onstart = () => {
            setRecState(prev => ({ ...prev, status: 'listening' }));
            if (globalTimeout) clearTimeout(globalTimeout);
            globalTimeout = setTimeout(() => { try { recognition.stop(); } catch(e) {} }, 20000); 
          };
          recognition.onresult = (event) => {
            if (globalTimeout) clearTimeout(globalTimeout);
            const spoken = event.results[0][0].transcript;
            processResult(id, targetText, spoken, diagnosticsConfig);
          };
          recognition.onerror = (event) => {
            if (globalTimeout) clearTimeout(globalTimeout);
            if (event.error === 'aborted') return;
            let msg = '無法辨識';
            if (event.error === 'not-allowed') msg = '請檢查麥克風權限';
            if (event.error === 'no-speech') msg = '沒聽到聲音';
            setRecState(prev => ({ ...prev, status: 'idle', feedbackMap: { ...prev.feedbackMap, [id]: { type: 'error', text: msg } } }));
          };
          recognition.onend = () => { setRecState(prev => { if (prev.activeId === id) return { ...prev, status: 'idle' }; return prev; }); };
          try { recognition.start(); } catch(e) { try { recognition.stop(); setTimeout(() => recognition.start(), 100); } catch(err) { setRecState(prev => ({ ...prev, status: 'idle' })); } }
        };

        const processResult = (id, targetText, spoken, diagnosticsConfig) => {
            const targetClean = cleanText(targetText); const spokenClean = cleanText(spoken);
            const targetWords = targetClean.split(' '); const spokenWords = spokenClean.split(' ');
            const functionWords = ['a', 'an', 'the', 'to', 'of', 'in', 'on', 'at', 'is', 'are', 'was', 'were', 'be', 'it', 'that', 'this', 'and', 'but', 'or', 'for', 'with', 'as'];
            let matchCount = 0; let missingContentWords = []; let missingFunctionWords = [];
            targetWords.forEach(w => { if (spokenWords.some(sw => sw === w || (sw.length > 3 && (sw.includes(w) || w.includes(sw))))) { matchCount++; } else { if (functionWords.includes(w)) { missingFunctionWords.push(w); } else { missingContentWords.push(w); } } });
            let accuracy = 0; if (targetWords.length > 0) accuracy = Math.round((matchCount / targetWords.length) * 100);
            if (targetWords.length <= 3) { if (spokenClean === targetClean) accuracy = 100; else accuracy = (spokenClean === targetClean) ? 100 : (accuracy > 90 ? 90 : accuracy); }
            let feedbackType = 'error'; let feedbackMsg = `請重新調整發音`; let adviceMsg = ""; let trapFound = false;
            if (diagnosticsConfig && diagnosticsConfig.traps) { Object.keys(diagnosticsConfig.traps).forEach(trapKey => { if (spokenClean.includes(trapKey.toLowerCase())) { adviceMsg = diagnosticsConfig.traps[trapKey]; trapFound = true; } }); }
            if (!trapFound && accuracy < 100) { if (missingContentWords.length > 0) { adviceMsg = `關鍵字 "${missingContentWords[0]}" 聲音不夠突出。這是句子的靈魂，請加強重音。`; } else if (missingFunctionWords.length > 0) { adviceMsg = `雖然有些虛字 (如 ${missingFunctionWords[0]}) 沒抓到，但別擔心。重點是語調流暢，注意連音即可。`; } else { adviceMsg = `語調似乎有點平淡，試著模仿示範音檔的抑揚頓挫。`; } }
            if (accuracy === 100) { feedbackType = 'success'; feedbackMsg = `完美無瑕！(Flawless)`; if (navigator.vibrate) navigator.vibrate(50); } else if (accuracy >= 90) { feedbackType = 'success'; feedbackMsg = `很好，語流順暢`; } else if (accuracy >= 80) { feedbackType = 'warning'; feedbackMsg = `不錯，注意細節`; } else if (accuracy >= 60) { feedbackType = 'warning'; feedbackMsg = `語調或發音有誤`; } else { feedbackType = 'error'; feedbackMsg = `請放慢速度，重新練習`; }
            const feedbackData = { type: feedbackType, text: feedbackMsg, score: accuracy, spokenText: spoken, targetText: targetText, advice: adviceMsg, intonationDisplay: diagnosticsConfig?.intonation || null };
            setRecState(prev => ({ ...prev, status: 'idle', feedbackMap: { ...prev.feedbackMap, [id]: feedbackData } }));
            setShowDetailsMap(prev => ({ ...prev, [id]: true }));
        };

        const toggleDetails = (id) => { setShowDetailsMap(prev => ({ ...prev, [id]: !prev[id] })); };
        const closeActiveFeedback = () => { if (recState.activeId) { setRecState(prev => ({ ...prev, feedbackMap: { ...prev.feedbackMap, [prev.activeId]: null } })); } };
        const availableUnits = useMemo(() => { const units = new Set(); initialVocabSections.forEach(s => s.unitId && units.add(s.unitId)); initialInterviewData.forEach(s => s.unitId && units.add(s.unitId)); return ['All', ...Array.from(units).sort()]; }, []);
        const filteredVocabSections = initialVocabSections.filter(section => selectedUnit === 'All' || section.unitId === selectedUnit);
        const filteredInterviewData = initialInterviewData.filter(section => selectedUnit === 'All' || section.unitId === selectedUnit);
        const themes = {
          blue: { bg: "bg-blue-50", border: "border-blue-200", title: "text-blue-800", typeTag: "bg-blue-600 text-white", btn: "bg-blue-600 hover:bg-blue-700", icon: "text-blue-600" },
          green: { bg: "bg-green-50", border: "border-green-200", title: "text-green-800", typeTag: "bg-green-600 text-white", btn: "bg-green-600 hover:bg-green-700", icon: "text-green-600" },
          amber: { bg: "bg-amber-50", border: "border-amber-200", title: "text-amber-800", typeTag: "bg-amber-600 text-white", btn: "bg-amber-600 hover:bg-amber-700", icon: "text-amber-600" },
          purple: { bg: "bg-purple-50", border: "border-purple-200", title: "text-purple-800", typeTag: "bg-purple-600 text-white", btn: "bg-purple-600 hover:bg-purple-700", icon: "text-purple-600" },
          teal: { bg: "bg-teal-50", border: "border-teal-200", title: "text-teal-800", typeTag: "bg-teal-600 text-white", btn: "bg-teal-600 hover:bg-teal-700", icon: "text-teal-600" },
          indigo: { bg: "bg-indigo-50", border: "border-indigo-200", title: "text-indigo-800", typeTag: "bg-indigo-600 text-white", btn: "bg-indigo-600 hover:bg-indigo-700", icon: "text-indigo-600" },
          orange: { bg: "bg-orange-50", border: "border-orange-200", title: "text-orange-800", typeTag: "bg-orange-600 text-white", btn: "bg-orange-600 hover:bg-orange-700", icon: "text-orange-600" },
          red: { bg: "bg-red-50", border: "border-red-200", title: "text-red-800", typeTag: "bg-red-600 text-white", btn: "bg-red-600 hover:bg-red-700", icon: "text-red-600" },
        };

        if (!hasStarted) return <StartScreen onStart={handleStartApp} />;
        const activeFeedback = recState.activeId ? recState.feedbackMap[recState.activeId] : null;
        const isShowDetails = recState.activeId ? showDetailsMap[recState.activeId] : false;

        return (
          <div id="app-container" className="relative min-h-screen">
            <div className="max-w-4xl mx-auto px-4 py-8 animate-fade-in pb-24 md:pb-8">
              <header className="text-center mb-6">
                <div className="inline-flex items-center justify-center p-3 bg-white rounded-full shadow-sm mb-4"><Briefcase className="w-8 h-8 text-blue-600 mr-2" /><span className="text-gray-500 font-medium">商務英文會話 (V15旗艦全收錄版)</span></div>
                <h1 className="text-3xl font-bold text-gray-800 mb-2 tracking-tight">面試與參展 <span className="text-blue-600">無縫特訓班</span></h1>
                <p className="text-gray-600 text-sm md:text-base">Unit 1 - 6 完整收錄：包含所有單字、句型與教練診斷！</p>
              </header>
              <div className="flex justify-center mb-6">
                <div className="bg-white p-2 rounded-lg shadow-sm border border-gray-200 flex items-center space-x-2">
                   <Filter className="w-5 h-5 text-gray-500" /><span className="text-sm font-bold text-gray-700">選擇單元：</span>
                   <select value={selectedUnit} onChange={(e) => setSelectedUnit(e.target.value)} className="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2 outline-none font-medium">
                     <option value="All">顯示全部課程 (Units 1-6)</option>
                     {availableUnits.filter(u => u !== 'All').map(u => <option key={u} value={u}>{u}</option>)}
                   </select>
                </div>
              </div>
              <div className="flex justify-center mb-10">
                <div className="bg-white p-1 rounded-xl shadow-sm border border-gray-200 flex overflow-x-auto">
                  <button onClick={() => setActiveTab('vocab')} className={`px-4 md:px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center whitespace-nowrap ${activeTab === 'vocab' ? 'bg-blue-600 text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'}`}><BookOpen className="w-4 h-4 mr-2" />1. 單字特訓</button>
                  <button onClick={() => setActiveTab('sentences')} className={`px-4 md:px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center whitespace-nowrap ${activeTab === 'sentences' ? 'bg-green-600 text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'}`}><MessageCircle className="w-4 h-4 mr-2" />2. 句型跟讀 (V15)</button>
                  <button onClick={() => setActiveTab('prepositions')} className={`px-4 md:px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center whitespace-nowrap ${activeTab === 'prepositions' ? 'bg-orange-600 text-white shadow-md' : 'text-gray-500 hover:bg-gray-50'}`}><Link2 className="w-4 h-4 mr-2" />3. 介係詞用法</button>
                </div>
              </div>

              {activeTab === 'sentences' && (
                 <div className="sticky top-2 z-20 mb-6 flex justify-center space-x-2">
                    <button onClick={() => setShowChunks(!showChunks)} className={`px-4 py-2 rounded-full shadow-md text-sm font-bold transition-all flex items-center ${showChunks ? 'bg-indigo-600 text-white' : 'bg-white text-gray-600 border border-gray-200'}`}><Scissors className="w-4 h-4 mr-1" />{showChunks ? '隱藏斷句' : '斷句輔助'}</button>
                    <button onClick={() => setIsBlindMode(!isBlindMode)} className={`px-4 py-2 rounded-full shadow-md text-sm font-bold transition-all flex items-center ${isBlindMode ? 'bg-black text-white' : 'bg-white text-gray-600 border border-gray-200'}`}>{isBlindMode ? <EyeOff className="w-4 h-4 mr-1" /> : <Eye className="w-4 h-4 mr-1" />}{isBlindMode ? '盲聽模式 ON' : '遮蔽文字'}</button>
                 </div>
              )}

              {activeTab === 'vocab' && (
                <div className="space-y-8">
                   {filteredVocabSections.length > 0 ? filteredVocabSections.map((section, idx) => (
                     <section key={idx}>
                       <div className="flex items-center mb-4 ml-1"><div className={`p-2 rounded-lg mr-3 bg-${section.color}-100 text-${section.color}-600`}><section.icon className="w-5 h-5" /></div><div><h2 className="text-xl font-bold text-gray-800">{section.title}</h2><p className="text-sm text-gray-500">{section.desc}</p></div></div>
                       <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">{section.words.map((word, wIdx) => <VocabCard key={wIdx} item={word} colorTheme={section.color} />)}</div>
                     </section>
                   )) : <div className="text-center py-10 text-gray-400 bg-gray-100 rounded-xl">無資料</div>}
                </div>
              )}

              {activeTab === 'sentences' && (
                <div className="space-y-8">
                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800 flex flex-col md:flex-row items-start md:items-center justify-between"><div className="flex items-start mb-2 md:mb-0"><MousePointerClick className="w-5 h-5 mr-2 mt-0.5 flex-shrink-0" /><span><strong>專業語感模式：</strong> 100% 正確才是合格。AI 教練會自動分辨關鍵字與虛字，給出最符合商務溝通的建議！</span></div></div>
                  {filteredInterviewData.length > 0 ? filteredInterviewData.map((section) => {
                    const theme = themes[section.colorTheme] || themes.blue; const SectionIcon = section.icon;
                    return (
                      <section key={section.id} className="bg-white rounded-2xl shadow-sm border border-gray-100">
                        <div className={`px-6 py-4 border-b ${theme.border} ${theme.bg} flex items-center justify-between rounded-t-2xl`}><div><h2 className={`text-xl font-bold ${theme.title} flex items-center`}>{section.category}</h2><p className="text-sm text-gray-600 mt-1 opacity-90">{section.desc}</p></div><SectionIcon className={`w-6 h-6 ${theme.icon} opacity-50`} /></div>
                        <div className="divide-y divide-gray-50">
                          {section.sentences.map((item) => (
                            <div key={item.id} onClick={() => speakText(item.plain, 0.85)} className="group p-6 hover:bg-gray-50 transition-colors cursor-pointer relative">
                              <div className="flex flex-col md:flex-row md:items-start justify-between gap-4">
                                <div className="flex-1">
                                  <span className={`inline-block text-xs font-bold px-2 py-0.5 rounded mb-2 ${theme.typeTag} opacity-80`}>{item.type}</span>
                                  <div className={`text-xl md:text-2xl text-gray-800 font-serif-en mb-3 ${theme.title}`}>{renderChunkedText(item.text, showChunks)}</div>
                                  <p className={`text-gray-600 font-medium text-sm md:text-base mb-3 transition-opacity ${isBlindMode ? 'opacity-0 group-hover:opacity-100' : 'opacity-100'}`}>{item.mean}</p>
                                  <div className={`inline-flex items-start text-xs md:text-sm text-gray-500 bg-gray-100 px-3 py-2 rounded-lg leading-relaxed transition-opacity ${isBlindMode ? 'opacity-0 group-hover:opacity-100' : 'opacity-100'}`}><Info className="w-4 h-4 mr-2 mt-0.5 text-gray-400 flex-shrink-0" /><span>{item.tip}</span></div>
                                </div>
                                <div className="flex items-center space-x-2 flex-shrink-0 self-end md:self-center mt-4 md:mt-0 opacity-80 group-hover:opacity-100 transition-opacity">
                                  <VoiceEvaluatorButton id={item.id} status={recState.activeId === item.id ? recState.status : 'idle'} feedback={recState.feedbackMap[item.id]} showDetails={showDetailsMap[item.id]} toggleDetails={() => toggleDetails(item.id)} onRecord={() => handleStartRecording(item.id, item.plain, { intonation: item.intonation, traps: item.traps })} />
                                  <button onClick={(e) => { e.stopPropagation(); speakText(item.plain, 0.75); }} className="flex items-center justify-center h-10 px-3 rounded-full bg-white border border-gray-200 text-green-600 hover:bg-green-50 hover:border-green-200 hover:scale-105 transition-all shadow-sm text-xs font-bold" title="慢速跟讀 (0.75x)"><Turtle className="w-4 h-4 mr-1" /> 0.75x</button>
                                  <button onClick={(e) => { e.stopPropagation(); speakText(item.plain, 1.0); }} className={`flex items-center justify-center h-10 px-3 rounded-full text-white hover:scale-105 transition-all shadow-md text-xs font-bold ${theme.btn}`} title="原速挑戰 (1.0x)"><Play className="w-4 h-4 mr-1" /> 1.0x</button>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </section>
                    );
                  }) : <div className="text-center py-10 text-gray-400 bg-gray-100 rounded-xl">無資料</div>}
                </div>
              )}

              {activeTab === 'prepositions' && (
                 <div className="space-y-6">
                   <div className="bg-orange-50 border border-orange-200 rounded-2xl p-6 shadow-sm mb-6"><div className="flex items-start gap-4"><div className="bg-orange-100 p-3 rounded-full text-orange-600"><Link2 className="w-8 h-8" /></div><div><h2 className="text-xl font-bold text-orange-900 mb-2">為什麼介係詞很重要？</h2><p className="text-orange-800 text-sm leading-relaxed">介係詞是單字間的「強力膠」。點擊下方卡片，注意粗體字的「連音」！</p></div></div></div>
                   <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                     {initialPrepositionData.map((item) => (
                       <div key={item.id} onClick={() => speakText(item.plain)} className="bg-white rounded-xl shadow-sm border border-orange-100 p-5 hover:shadow-md hover:border-orange-300 transition-all cursor-pointer group flex flex-col">
                         <div className="flex justify-between items-start mb-3"><span className="inline-block px-3 py-1 bg-orange-100 text-orange-700 text-sm font-bold rounded-full">{item.phrase}</span><div className="flex items-center gap-2"><VoiceEvaluatorButton id={item.id} status={recState.activeId === item.id ? recState.status : 'idle'} feedback={recState.feedbackMap[item.id]} showDetails={showDetailsMap[item.id]} toggleDetails={() => toggleDetails(item.id)} onRecord={() => handleStartRecording(item.id, item.plain)} /><Volume2 className="w-5 h-5 text-gray-300 group-hover:text-orange-500 transition-colors" /></div></div>
                         <div className="mb-4 flex-grow"><h3 className="text-lg md:text-xl text-gray-800 font-serif-en mb-2 leading-relaxed"><InteractiveSentence htmlContent={item.sentence} isBlindMode={false} /></h3><p className="text-gray-500 text-sm font-medium">{item.mean}</p></div>
                         <div className="mt-auto pt-3 border-t border-gray-50"><div className="flex items-start text-xs text-orange-600 bg-orange-50 p-2 rounded-lg"><Zap className="w-3 h-3 mr-1.5 mt-0.5 flex-shrink-0" />{item.tip}</div></div>
                       </div>
                     ))}
                   </div>
                </div>
              )}
            </div>
            <MobileFeedbackToast feedback={activeFeedback} showDetails={isShowDetails} toggleDetails={() => toggleDetails(recState.activeId)} onClose={closeActiveFeedback} />
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<InterviewPracticeApp />);
    </script>
</body>
</html>
